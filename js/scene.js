// koffee 1.6.0

/*
 0000000   0000000  00000000  000   000  00000000
000       000       000       0000  000  000     
0000000   000       0000000   000 0 000  0000000 
     000  000       000       000  0000  000     
0000000    0000000  00000000  000   000  00000000
 */
var Color3, GUI, Legend, Mesh, MeshBuilder, Scene, StandardMaterial, Vect, Vector3, VertexBuffer, babylon, generate, ref, valid, vec,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

valid = require('kxk').valid;

ref = require('babylonjs'), Color3 = ref.Color3, Mesh = ref.Mesh, MeshBuilder = ref.MeshBuilder, Scene = ref.Scene, StandardMaterial = ref.StandardMaterial, Vector3 = ref.Vector3, VertexBuffer = ref.VertexBuffer;

vec = require('./poly/math').vec;

babylon = require('babylonjs');

GUI = require('babylonjs-gui');

Vect = require('./vect');

Legend = require('./legend');

generate = require('./poly/generate');

Scene = (function(superClass) {
    extend(Scene, superClass);

    function Scene(world) {
        this.world = world;
        Scene.__super__.constructor.call(this, this.world.engine);
        this.ui = GUI.AdvancedDynamicTexture.CreateFullscreenUI('ui');
        this.legend = new Legend(this.ui);
        this.faceIndexMat = new StandardMaterial('faceIndexMat');
        this.faceIndexMat.diffuseColor = new Color3(.5, .5, 1);
        this.faceIndexMat.alpha = 0.5;
        this.vertIndexMat = new StandardMaterial('vertIndexMat');
        this.vertIndexMat.diffuseColor = new Color3(1, 1, 1);
        this.vertIndexMat.alpha = 0.5;
        this.style = this.ui.createStyle();
        this.style.fontSize = 10;
        this.style.fontFamily = 'fontMono';
        this.style.height = '20px';
    }

    Scene.prototype.initFog = function(color) {
        if (color != null) {
            color;
        } else {
            color = new Color3(0, 0, 0);
        }
        this.fogColor = color;
        return this.fogMode = Scene.FOGMODE_LINEAR;
    };

    Scene.prototype.render = function() {
        this.fogStart = this.world.space.distance * 3;
        this.fogEnd = 2 * this.fogStart;
        return Scene.__super__.render.apply(this, arguments);
    };

    Scene.prototype.showNormals = function(mesh, size, color) {
        var i, j, lines, normals, positions, ref1, system, v1, v2;
        normals = mesh.getVerticesData(VertexBuffer.NormalKind);
        positions = mesh.getVerticesData(VertexBuffer.PositionKind);
        if (color != null) {
            color;
        } else {
            color = new Color3(0.2, 0.2, 0.2);
        }
        if (size != null) {
            size;
        } else {
            size = 0.2;
        }
        lines = [];
        for (i = j = 0, ref1 = normals.length; j < ref1; i = j += 3) {
            v1 = Vector3.FromArray(positions, i);
            v2 = v1.addInPlace(Vector3.FromArray(normals, i).scaleInPlace(size));
            lines.push([v1, v2]);
        }
        system = MeshBuilder.CreateLineSystem('normals', {
            lines: lines
        });
        system.color = color;
        mesh.addChild(system);
        return system;
    };

    Scene.prototype.showDebug = function(mesh, poly) {
        var lines, system;
        if (valid(poly.debug)) {
            lines = poly.debug.map(function(dbg) {
                return dbg.map(function(v) {
                    return vec(v);
                });
            });
            system = MeshBuilder.CreateLineSystem('faces', {
                lines: lines
            });
            system.color = new Color3(1, 1, 0);
            system.alpha = 0.5;
            mesh.addChild(system);
            return system;
        }
    };

    Scene.prototype.showFaces = function(mesh, poly, color) {
        var face, j, k, len, lines, ref1, ref2, system, v1, v2, vi;
        if (color != null) {
            color;
        } else {
            color = new Color3(0, 0, 0);
        }
        lines = [];
        ref1 = poly.face;
        for (j = 0, len = ref1.length; j < len; j++) {
            face = ref1[j];
            v1 = poly.vert(face.slice(-1)[0]);
            for (vi = k = 0, ref2 = face.length; 0 <= ref2 ? k < ref2 : k > ref2; vi = 0 <= ref2 ? ++k : --k) {
                v2 = poly.vert(face[vi]);
                lines.push([v1, v2]);
                v1 = v2;
            }
        }
        system = MeshBuilder.CreateLineSystem('faces', {
            lines: lines,
            useVertexAlpha: false
        });
        system.color = color;
        mesh.addChild(system);
        return system;
    };

    Scene.prototype.showIndices = function(mesh, poly) {
        var c, ctr, d, fi, j, k, len, len1, normals, ref1, ref2, results, vi, vx;
        ref1 = poly.vertex;
        for (vi = j = 0, len = ref1.length; j < len; vi = ++j) {
            vx = ref1[vi];
            d = Mesh.CreatePolyhedron("" + vi, {
                custom: generate('O').scale(0.1)
            }, this);
            d.material = this.vertIndexMat;
            mesh.addChild(d);
            d.locallyTranslate(poly.vert(vi));
            d.lookAt(poly.vert(vi).plus(vec(poly.vertexNormal(vi))));
            this.label(d);
        }
        normals = poly.normals();
        ref2 = poly.centers();
        results = [];
        for (fi = k = 0, len1 = ref2.length; k < len1; fi = ++k) {
            ctr = ref2[fi];
            c = Mesh.CreatePolyhedron("" + fi, {
                custom: generate('C').scale(0.1)
            }, this);
            c.material = this.faceIndexMat;
            mesh.addChild(c);
            c.locallyTranslate(vec(ctr));
            c.lookAt(vec(ctr).plus(normals[fi]));
            results.push(this.label(c));
        }
        return results;
    };

    Scene.prototype.label = function(mesh, name) {
        var text;
        if (name == null) {
            name = mesh.name;
        }
        text = new GUI.TextBlock();
        text.text = name;
        text.color = "black";
        text.style = this.style;
        this.ui.addControl(text);
        return text.linkWithMesh(mesh);
    };

    return Scene;

})(babylon.Scene);

module.exports = Scene;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NlbmUuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7QUFBQSxJQUFBLGdJQUFBO0lBQUE7OztBQVFFLFFBQVUsT0FBQSxDQUFRLEtBQVI7O0FBQ1osTUFBZ0YsT0FBQSxDQUFRLFdBQVIsQ0FBaEYsRUFBRSxtQkFBRixFQUFVLGVBQVYsRUFBZ0IsNkJBQWhCLEVBQTZCLGlCQUE3QixFQUFvQyx1Q0FBcEMsRUFBc0QscUJBQXRELEVBQStEOztBQUM3RCxNQUFRLE9BQUEsQ0FBUSxhQUFSOztBQUNWLE9BQUEsR0FBVyxPQUFBLENBQVEsV0FBUjs7QUFDWCxHQUFBLEdBQVcsT0FBQSxDQUFRLGVBQVI7O0FBQ1gsSUFBQSxHQUFXLE9BQUEsQ0FBUSxRQUFSOztBQUNYLE1BQUEsR0FBVyxPQUFBLENBQVEsVUFBUjs7QUFDWCxRQUFBLEdBQVcsT0FBQSxDQUFRLGlCQUFSOztBQUVMOzs7SUFFQyxlQUFDLEtBQUQ7UUFBQyxJQUFDLENBQUEsUUFBRDtRQUVBLHVDQUFNLElBQUMsQ0FBQSxLQUFLLENBQUMsTUFBYjtRQUVBLElBQUMsQ0FBQSxFQUFELEdBQU0sR0FBRyxDQUFDLHNCQUFzQixDQUFDLGtCQUEzQixDQUE4QyxJQUE5QztRQUVOLElBQUMsQ0FBQSxNQUFELEdBQVUsSUFBSSxNQUFKLENBQVcsSUFBQyxDQUFBLEVBQVo7UUFFVixJQUFDLENBQUEsWUFBRCxHQUFnQixJQUFJLGdCQUFKLENBQXFCLGNBQXJCO1FBQ2hCLElBQUMsQ0FBQSxZQUFZLENBQUMsWUFBZCxHQUE2QixJQUFJLE1BQUosQ0FBVyxFQUFYLEVBQWMsRUFBZCxFQUFpQixDQUFqQjtRQUM3QixJQUFDLENBQUEsWUFBWSxDQUFDLEtBQWQsR0FBc0I7UUFFdEIsSUFBQyxDQUFBLFlBQUQsR0FBZ0IsSUFBSSxnQkFBSixDQUFxQixjQUFyQjtRQUNoQixJQUFDLENBQUEsWUFBWSxDQUFDLFlBQWQsR0FBNkIsSUFBSSxN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SSxJQUFJLENBQUMsZ0JBQUwsQ0FBc0IsRUFBQSxHQUFHLEVBQXpCLEVBQThCO2dCQUFDLE1BQUEsRUFBTyxRQUFBLENBQVMsR0FBVCxDQUFhLENBQUMsS0FBZCxDQUFvQixHQUFwQixDQUFSO2FBQTlCLEVBQWlFLElBQWpFO1lBQ0osQ0FBQyxDQUFDLFFBQUYsR0FBYSxJQUFDLENBQUE7WUFDZCxJQUFJLENBQUMsUUFBTCxDQUFjLENBQWQ7WUFDQSxDQUFDLENBQUMsZ0JBQUYsQ0FBbUIsR0FBQSxDQUFJLEdBQUosQ0FBbkI7WUFDQSxDQUFDLENBQUMsTUFBRixDQUFTLEdBQUEsQ0FBSSxHQUFKLENBQVEsQ0FBQyxJQUFULENBQWMsT0FBUSxDQUFBLEVBQUEsQ0FBdEIsQ0FBVDt5QkFDQSxJQUFDLENBQUEsS0FBRCxDQUFPLENBQVA7QUFOSjs7SUFaUzs7b0JBMEJiLEtBQUEsR0FBTyxTQUFDLElBQUQsRUFBTyxJQUFQO0FBWUgsWUFBQTs7WUFaVSxPQUFLLElBQUksQ0FBQzs7UUFZcEIsSUFBQSxHQUFPLElBQUksR0FBRyxDQUFDLFNBQVIsQ0FBQTtRQUNQLElBQUksQ0FBQyxJQUFMLEdBQVk7UUFDWixJQUFJLENBQUMsS0FBTCxHQUFhO1FBQ2IsSUFBSSxDQUFDLEtBQUwsR0FBYSxJQUFDLENBQUE7UUFDZCxJQUFDLENBQUEsRUFBRSxDQUFDLFVBQUosQ0FBZSxJQUFmO2VBQ0EsSUFBSSxDQUFDLFlBQUwsQ0FBa0IsSUFBbEI7SUFqQkc7Ozs7R0FySVMsT0FBTyxDQUFDOztBQXdKNUIsTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDBcbjAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgIDAwMDAgIDAwMCAgMDAwICAgICBcbjAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgIDAwMCAwIDAwMCAgMDAwMDAwMCBcbiAgICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgMDAwMCAgMDAwICAgICBcbjAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDBcbiMjI1xuXG57IHZhbGlkIH0gPSByZXF1aXJlICdreGsnXG57IENvbG9yMywgTWVzaCwgTWVzaEJ1aWxkZXIsIFNjZW5lLCBTdGFuZGFyZE1hdGVyaWFsLCBWZWN0b3IzLCBWZXJ0ZXhCdWZmZXIgfSA9IHJlcXVpcmUgJ2JhYnlsb25qcydcbnsgdmVjIH0gPSByZXF1aXJlICcuL3BvbHkvbWF0aCdcbmJhYnlsb24gID0gcmVxdWlyZSAnYmFieWxvbmpzJ1xuR1VJICAgICAgPSByZXF1aXJlICdiYWJ5bG9uanMtZ3VpJ1xuVmVjdCAgICAgPSByZXF1aXJlICcuL3ZlY3QnXG5MZWdlbmQgICA9IHJlcXVpcmUgJy4vbGVnZW5kJ1xuZ2VuZXJhdGUgPSByZXF1aXJlICcuL3BvbHkvZ2VuZXJhdGUnXG5cbmNsYXNzIFNjZW5lIGV4dGVuZHMgYmFieWxvbi5TY2VuZSBcblxuICAgIEA6IChAd29ybGQpIC0+XG4gICAgXG4gICAgICAgIHN1cGVyIEB3b3JsZC5lbmdpbmVcbiAgICAgICAgXG4gICAgICAgIEB1aSA9IEdVSS5BZHZhbmNlZER5bmFtaWNUZXh0dXJlLkNyZWF0ZUZ1bGxzY3JlZW5VSSAndWknXG4gICAgICAgIFxuICAgICAgICBAbGVnZW5kID0gbmV3IExlZ2VuZCBAdWlcbiAgICAgICAgXG4gICAgICAgIEBmYWNlSW5kZXhNYXQgPSBuZXcgU3RhbmRhcmRNYXRlcmlhbCAnZmFjZUluZGV4TWF0J1xuICAgICAgICBAZmFjZUluZGV4TWF0LmRpZmZ1c2VDb2xvciA9IG5ldyBDb2xvcjMgLjUgLjUgMSAgICAgICAgICAgIFxuICAgICAgICBAZmFjZUluZGV4TWF0LmFscGhhID0gMC41XG5cbiAgICAgICAgQHZlcnRJbmRleE1hdCA9IG5ldyBTdGFuZGFyZE1hdGVyaWFsICd2ZXJ0SW5kZXhNYXQnXG4gICAgICAgIEB2ZXJ0SW5kZXhNYXQuZGlmZnVzZUNvbG9yID0gbmV3IENvbG9yMyAxIDEgMVxuICAgICAgICBAdmVydEluZGV4TWF0LmFscGhhID0gMC41XG4gICAgICAgIFxuICAgICAgICBAc3R5bGUgPSBAdWkuY3JlYXRlU3R5bGUoKVxuICAgICAgICBAc3R5bGUuZm9udFNpemUgPSAxMFxuICAgICAgICBAc3R5bGUuZm9udEZhbWlseSA9ICdmb250TW9ubydcbiAgICAgICAgQHN0eWxlLmhlaWdodCA9ICcyMHB4J1xuXG4gICAgaW5pdEZvZzogKGNvbG9yKSAtPlxuXG4gICAgICAgIGNvbG9yID89IG5ldyBDb2xvcjMgMCAwIDBcbiAgICAgICAgQGZvZ0NvbG9yID0gY29sb3JcbiAgICAgICAgQGZvZ01vZGUgID0gU2NlbmUuRk9HTU9ERV9MSU5FQVJcbiAgICAgICAgXG4gICAgcmVuZGVyOiAtPlxuICAgICAgICAgICAgXG4gICAgICAgIEBmb2dTdGFydCA9IEB3b3JsZC5zcGFjZS5kaXN0YW5jZSAqIDNcbiAgICAgICAgQGZvZ0VuZCAgID0gMipAZm9nU3RhcnRcbiAgICAgICAgc3VwZXJcbiAgICAgICAgICAgIFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICBcbiAgICAjIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAgMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAwMDAwMDAwICAgXG4gICAgXG4gICAgc2hvd05vcm1hbHM6IChtZXNoLCBzaXplLCBjb2xvcilcci0+XG4gICAgICAgIFxuICAgICAgICBub3JtYWxzICAgPSBtZXNoLmdldFZlcnRpY2VzRGF0YSBWZXJ0ZXhCdWZmZXIuTm9ybWFsS2luZFxuICAgICAgICBwb3NpdGlvbnMgPSBtZXNoLmdldFZlcnRpY2VzRGF0YSBWZXJ0ZXhCdWZmZXIuUG9zaXRpb25LaW5kXG4gICAgICAgIGNvbG9yID89IG5ldyBDb2xvcjMgMC4yIDAuMiAwLjJcbiAgICAgICAgc2l6ZSAgPz0gMC4yXG4gICAgICAgIGxpbmVzICA9IFtdXG4gICAgICAgIFxuICAgICAgICBmb3IgaSBpbiBbMC4uLm5vcm1hbHMubGVuZ3RoXSBieSAzXG4gICAgICAgICAgICB2MSA9IFZlY3RvcjMuRnJvbUFycmF5IHBvc2l0aW9ucywgaVxuICAgICAgICAgICAgdjIgPSB2MS5hZGRJblBsYWNlIFZlY3RvcjMuRnJvbUFycmF5KG5vcm1hbHMsIGkpLnNjYWxlSW5QbGFjZShzaXplKVxuICAgICAgICAgICAgbGluZXMucHVzaCBbdjEsIHYyXVxuICAgICAgICAgICAgXG4gICAgICAgIHN5c3RlbSA9IE1lc2hCdWlsZGVyLkNyZWF0ZUxpbmVTeXN0ZW0gJ25vcm1hbHMnIGxpbmVzOmxpbmVzXG4gICAgICAgIHN5c3RlbS5jb2xvciA9IGNvbG9yXG4gICAgICAgIG1lc2guYWRkQ2hpbGQgc3lzdGVtXG4gICAgICAgIHN5c3RlbVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwMCAgMDAwMDAwMCAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgXG4gICAgXG4gICAgc2hvd0RlYnVnOiAobWVzaCwgcG9seSlcci0+XG4gICAgICAgIFxuICAgICAgICBpZiB2YWxpZCBwb2x5LmRlYnVnXG4gICAgICAgICAgICBsaW5lcyA9IHBvbHkuZGVidWcubWFwIChkYmcpIC0+IGRiZy5tYXAgKHYpIC0+IHZlYyB2XG4gICAgICAgICAgICBzeXN0ZW0gPSBNZXNoQnVpbGRlci5DcmVhdGVMaW5lU3lzdGVtICdmYWNlcycgbGluZXM6bGluZXNcbiAgICAgICAgICAgICMgc3lzdGVtLnNjYWxpbmcgPSB2ZWMgMS4wMyAxLjAzIDEuMDNcbiAgICAgICAgICAgIHN5c3RlbS5jb2xvciA9IG5ldyBDb2xvcjMgMSAxIDBcbiAgICAgICAgICAgIHN5c3RlbS5hbHBoYSA9IDAuNVxuICAgICAgICAgICAgbWVzaC5hZGRDaGlsZCBzeXN0ZW1cbiAgICAgICAgICAgIHN5c3RlbVxuICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgICAgICAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgXG4gICAgXG4gICAgc2hvd0ZhY2VzOiAobWVzaCwgcG9seSwgY29sb3IpXHItPlxuICAgICAgICAgICAgICAgIFxuICAgICAgICBjb2xvciA/PSBuZXcgQ29sb3IzIDAgMCAwICMwLjA2IDAuMDYgMC4wNlxuICAgICAgICBsaW5lcyAgPSBbXVxuXG4gICAgICAgIGZvciBmYWNlIGluIHBvbHkuZmFjZVxuICAgICAgICAgICAgdjEgPSBwb2x5LnZlcnQgZmFjZVstMV1cbiAgICAgICAgICAgIGZvciB2aSBpbiBbMC4uLmZhY2UubGVuZ3RoXVxuICAgICAgICAgICAgICAgIHYyID0gcG9seS52ZXJ0IGZhY2VbdmldXG4gICAgICAgICAgICAgICAgbGluZXMucHVzaCBbdjEsIHYyXVxuICAgICAgICAgICAgICAgIHYxID0gdjJcbiAgICAgICAgICAgIFxuICAgICAgICBzeXN0ZW0gPSBNZXNoQnVpbGRlci5DcmVhdGVMaW5lU3lzdGVtICdmYWNlcycgbGluZXM6bGluZXMsIHVzZVZlcnRleEFscGhhOmZhbHNlXG4gICAgICAgICMgc3lzdGVtID0gbmV3IExpbmVzTWVzaCAnZmFjZXMnIHBhcmVudDptZXNoLCB1c2VWZXJ0ZXhBbHBoYTpmYWxzZVxuICAgICAgICAjIHN5c3RlbS5zY2FsaW5nID0gdmVjIDEuMDA1IDEuMDA1IDEuMDA1XG4gICAgICAgIHN5c3RlbS5jb2xvciA9IGNvbG9yXG4gICAgICAgIG1lc2guYWRkQ2hpbGQgc3lzdGVtXG4gICAgICAgIHN5c3RlbVxuICAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgICAgICAgICAgMDAwICBcbiAgICAjIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwICAgXG4gICAgXG4gICAgc2hvd0luZGljZXM6IChtZXNoLCBwb2x5KSAtPlxuXG4gICAgICAgIGZvciB2eCx2aSBpbiBwb2x5LnZlcnRleFxuICAgICAgICAgICAgZCA9IE1lc2guQ3JlYXRlUG9seWhlZHJvbiBcIiN7dml9XCIge2N1c3RvbTpnZW5lcmF0ZSgnTycpLnNjYWxlKDAuMSl9LCBAXG4gICAgICAgICAgICBkLm1hdGVyaWFsID0gQHZlcnRJbmRleE1hdFxuICAgICAgICAgICAgbWVzaC5hZGRDaGlsZCBkXG4gICAgICAgICAgICBkLmxvY2FsbHlUcmFuc2xhdGUgcG9seS52ZXJ0IHZpXG4gICAgICAgICAgICBkLmxvb2tBdCBwb2x5LnZlcnQodmkpLnBsdXMgdmVjIHBvbHkudmVydGV4Tm9ybWFsIHZpXG4gICAgICAgICAgICBAbGFiZWwgZCBcbiAgICAgICAgICAgIFxuICAgICAgICBub3JtYWxzID0gcG9seS5ub3JtYWxzKClcbiAgICAgICAgICAgIFxuICAgICAgICBmb3IgY3RyLGZpIGluIHBvbHkuY2VudGVycygpXG4gICAgICAgICAgICBjID0gTWVzaC5DcmVhdGVQb2x5aGVkcm9uIFwiI3tmaX1cIiB7Y3VzdG9tOmdlbmVyYXRlKCdDJykuc2NhbGUoMC4xKX0sIEBcbiAgICAgICAgICAgIGMubWF0ZXJpYWwgPSBAZmFjZUluZGV4TWF0XG4gICAgICAgICAgICBtZXNoLmFkZENoaWxkIGNcbiAgICAgICAgICAgIGMubG9jYWxseVRyYW5zbGF0ZSB2ZWMgY3RyXG4gICAgICAgICAgICBjLmxvb2tBdCB2ZWMoY3RyKS5wbHVzIG5vcm1hbHNbZmldXG4gICAgICAgICAgICBAbGFiZWwgYyBcbiAgICAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgICAgIFxuICAgICMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICBcbiAgICAjIDAwMCAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgICAgXG4gICAgIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgIFxuICAgICMgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAwICAwMDAwMDAwICBcbiAgICBcbiAgICBsYWJlbDogKG1lc2gsIG5hbWU9bWVzaC5uYW1lKSAtPlxuICAgICAgICBcbiAgICAgICAgIyBsYWJlbCA9IG5ldyBHVUkuUmVjdGFuZ2xlIFwibGFiZWxfI3ttZXNoLm5hbWV9XCJcclxuICAgICAgICAjIGxhYmVsLmJhY2tncm91bmQgPSBcIndoaXRlXCJcclxuICAgICAgICAjIGxhYmVsLmhlaWdodCA9IFwiMjBweFwiXG4gICAgICAgICMgbGFiZWwuYWxwaGEgPSAxXG4gICAgICAgICMgbGFiZWwud2lkdGggPSBcIiN7bmFtZS5sZW5ndGgqOH1weFwiXG4gICAgICAgICMgbGFiZWwuY29ybmVyUmFkaXVzID0gMTBcbiAgICAgICAgIyBsYWJlbC50aGlja25lc3MgPSAwXG4gICAgICAgICMgQHVpLmFkZENvbnRyb2wgbGFiZWxcbiAgICAgICAgIyBsYWJlbC5saW5rV2l0aE1lc2ggbWVzaFxuXHJcbiAgICAgICAgdGV4dCA9IG5ldyBHVUkuVGV4dEJsb2NrKClcbiAgICAgICAgdGV4dC50ZXh0ID0gbmFtZVxuICAgICAgICB0ZXh0LmNvbG9yID0gXCJibGFja1wiXHJcbiAgICAgICAgdGV4dC5zdHlsZSA9IEBzdHlsZVxuICAgICAgICBAdWkuYWRkQ29udHJvbCB0ZXh0XG4gICAgICAgIHRleHQubGlua1dpdGhNZXNoIG1lc2hcclxuXG5tb2R1bGUuZXhwb3J0cyA9IFNjZW5lXG4iXX0=
//# sourceURL=../coffee/scene.coffee