// koffee 1.6.0

/*
 0000000   0000000   00     00  00000000  00000000    0000000 
000       000   000  000   000  000       000   000  000   000
000       000000000  000000000  0000000   0000000    000000000
000       000   000  000 0 000  000       000   000  000   000
 0000000  000   000  000   000  00000000  000   000  000   000
 */
var ArcRotateCamera, Camera, FlyCamera, FramingBehavior, Quat, UniversalCamera, Vect, clamp, quat, reduce, ref, ref1, vec,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

ref = require('kxk'), reduce = ref.reduce, clamp = ref.clamp;

ref1 = require('babylonjs'), UniversalCamera = ref1.UniversalCamera, ArcRotateCamera = ref1.ArcRotateCamera, FlyCamera = ref1.FlyCamera, FramingBehavior = ref1.FramingBehavior;

Vect = require('./vect');

Quat = require('./quat');

vec = function(x, y, z) {
    return new Vect(x, y, z);
};

quat = function(x, y, z, w) {
    return new Quat(x, y, z, w);
};

Camera = (function(superClass) {
    extend(Camera, superClass);

    function Camera(scene, view, canvas) {
        this.scene = scene;
        this.setDistFactor = bind(this.setDistFactor, this);
        this.inertZoom = bind(this.inertZoom, this);
        this.onMouseWheel = bind(this.onMouseWheel, this);
        this.moveCenter = bind(this.moveCenter, this);
        this.fadeCenter = bind(this.fadeCenter, this);
        this.pivotCenter = bind(this.pivotCenter, this);
        this.onMouseDrag = bind(this.onMouseDrag, this);
        this.onDblClick = bind(this.onDblClick, this);
        this.onMouseUp = bind(this.onMouseUp, this);
        this.onMouseDown = bind(this.onMouseDown, this);
        this.del = bind(this.del, this);
        Camera.__super__.constructor.call(this, 'Camera', vec(0, 0, -10), this.scene);
        this.attachControl(canvas, false);
        this.wheelDeltaPercentage = 0.02;
        this.inertia = 0.7;
        this.speed = 1;
        this.lowerRadiusLimit = 2;
        this.upperRadiusLimit = 100;
        this.useFramingBehavior = true;
        FramingBehavior.mode = FramingBehavior.FitFrustumSidesMode;
        FramingBehavior.radiusScale = 4;
    }

    Camera.prototype.del = function() {
        this.elem.removeEventListener('keypress', this.onKeyPress);
        this.elem.removeEventListener('keyrelease', this.onKeyRelease);
        this.elem.removeEventListener('mousewheel', this.onMouseWheel);
        this.elem.removeEventListener('mousedown', this.onMouseDown);
        this.elem.removeEventListener('dblclick', this.onDblClick);
        window.removeEventListener('mouseup', this.onMouseUp);
        return window.removeEventListener('mousemove', this.onMouseDrag);
    };

    Camera.prototype.onMouseDown = function(event) {
        this.downButtons = event.buttons;
        this.mouseMoved = false;
        this.mouseX = event.clientX;
        this.mouseY = event.clientY;
        this.downPos = vec(this.mouseX, this.mouseY);
        window.addEventListener('mousemove', this.onMouseDrag);
        return window.addEventListener('mouseup', this.onMouseUp);
    };

    Camera.prototype.onMouseUp = function(event) {
        window.removeEventListener('mousemove', this.onMouseDrag);
        return window.removeEventListener('mouseup', this.onMouseUp);
    };

    Camera.prototype.onDblClick = function(event) {};

    Camera.prototype.onMouseDrag = function(event) {
        var s, x, y;
        x = event.clientX - this.mouseX;
        y = event.clientY - this.mouseY;
        this.mouseX = event.clientX;
        this.mouseY = event.clientY;
        if (this.downPos.dist(vec(this.mouseX, this.mouseY)) > 60) {
            this.mouseMoved = true;
        }
        if (event.buttons & 4) {
            s = this.dist;
            this.pan(x * 2 * s / this.size.x, y * s / this.size.y);
        }
        if (event.buttons & 2) {
            return this.pivot(4000 * x / this.size.x, 2000 * y / this.size.y);
        }
    };

    Camera.prototype.pivot = function(x, y) {
        this.rotate += -0.1 * x;
        this.degree += -0.1 * y;
        return this.update();
    };

    Camera.prototype.startPivotLeft = function() {
        this.pivotX = 20;
        return this.startPivot();
    };

    Camera.prototype.startPivotRight = function() {
        this.pivotX = -20;
        return this.startPivot();
    };

    Camera.prototype.startPivotUp = function() {
        this.pivotY = -10;
        return this.startPivot();
    };

    Camera.prototype.startPivotDown = function() {
        this.pivotY = 10;
        return this.startPivot();
    };

    Camera.prototype.stopPivot = function() {
        this.pivoting = false;
        this.pivotX = 0;
        return this.pivotY = 0;
    };

    Camera.prototype.startPivot = function() {
        if (!this.pivoting) {
            return this.pivoting = true;
        }
    };

    Camera.prototype.pivotCenter = function(deltaSeconds) {
        if (!this.pivoting) {
            return;
        }
        return this.pivot(this.pivotX, this.pivotY);
    };

    Camera.prototype.pan = function(x, y) {
        var ref2, right, up;
        right = vec(-x, 0, 0);
        right.applyQuaternion(this.rotationQuaternion);
        up = vec(0, y, 0);
        up.applyQuaternion(this.rotationQuaternion);
        this.center.add(right.add(up));
        if ((ref2 = this.centerTarget) != null) {
            ref2.copy(this.center);
        }
        return this.update();
    };

    Camera.prototype.focusOnPos = function(v) {
        this.centerTarget = vec(v);
        this.center = vec(v);
        return this.update();
    };

    Camera.prototype.fadeToPos = function(v) {
        this.centerTarget = vec(v);
        return this.startFadeCenter();
    };

    Camera.prototype.startFadeCenter = function() {
        if (!this.fading) {
            return this.fading = true;
        }
    };

    Camera.prototype.fadeCenter = function(deltaSeconds) {
        if (!this.fading) {
            return;
        }
        this.center.fade(this.centerTarget, deltaSeconds);
        this.update();
        if (this.center.dist(this.centerTarget) > 0.00001) {
            return true;
        } else {
            return delete this.fading;
        }
    };

    Camera.prototype.moveFactor = function() {
        return this.dist / 2;
    };

    Camera.prototype.startMoveLeft = function() {
        this.moveX = -this.moveFactor();
        return this.startMove();
    };

    Camera.prototype.startMoveRight = function() {
        this.moveX = this.moveFactor();
        return this.startMove();
    };

    Camera.prototype.startMoveUp = function() {
        this.moveY = this.moveFactor();
        return this.startMove();
    };

    Camera.prototype.startMoveDown = function() {
        this.moveY = -this.moveFactor();
        return this.startMove();
    };

    Camera.prototype.stopMoving = function() {
        this.moving = false;
        this.moveX = 0;
        return this.moveY = 0;
    };

    Camera.prototype.startMove = function() {
        this.fading = false;
        if (!this.moving) {
            rts.animate(this.moveCenter);
            return this.moving = true;
        }
    };

    Camera.prototype.moveCenter = function(deltaSeconds) {
        var dir;
        if (!this.moving) {
            return;
        }
        dir = vec();
        dir.add(Vect.unitX.mul(this.moveX));
        dir.add(Vect.unitY.mul(this.moveY));
        dir.scale(deltaSeconds);
        dir.applyQuaternion(this.rotationQuaternion);
        this.center.add(dir);
        this.update();
        return rts.animate(this.moveCenter);
    };

    Camera.prototype.onMouseWheel = function(event) {
        if (this.wheelInert > 0 && event.wheelDelta < 0) {
            this.wheelInert = 0;
            return;
        }
        if (this.wheelInert < 0 && event.wheelDelta > 0) {
            this.wheelInert = 0;
            return;
        }
        this.wheelInert += event.wheelDelta * (1 + (this.dist / this.maxDist) * 3) * 0.0001;
        return this.startZoom();
    };

    Camera.prototype.startZoomIn = function() {
        this.wheelInert = (1 + (this.dist / this.maxDist) * 3) * 10;
        return this.startZoom();
    };

    Camera.prototype.startZoomOut = function() {
        this.wheelInert = -(1 + (this.dist / this.maxDist) * 3) * 10;
        return this.startZoom();
    };

    Camera.prototype.startZoom = function() {
        if (!this.zooming) {
            return this.zooming = true;
        }
    };

    Camera.prototype.stopZoom = function() {
        this.wheelInert = 0;
        return this.zooming = false;
    };

    Camera.prototype.inertZoom = function(deltaSeconds) {
        this.setDistFactor(1 - clamp(-0.02, 0.02, this.wheelInert));
        this.wheelInert = reduce(this.wheelInert, deltaSeconds * 0.3);
        if (Math.abs(this.wheelInert) > 0.00000001) {
            return true;
        } else {
            delete this.zooming;
            return this.wheelInert = 0;
        }
    };

    Camera.prototype.setDistFactor = function(factor) {
        this.dist = clamp(this.minDist, this.maxDist, this.dist * factor);
        return this.update();
    };

    Camera.prototype.setFov = function(fov) {
        return this.fov = Math.max(2.0, Math.min(fov, 175.0));
    };

    return Camera;

})(UniversalCamera);

module.exports = Camera;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FtZXJhLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxxSEFBQTtJQUFBOzs7O0FBUUEsTUFBb0IsT0FBQSxDQUFRLEtBQVIsQ0FBcEIsRUFBRSxtQkFBRixFQUFVOztBQUNWLE9BQW1FLE9BQUEsQ0FBUSxXQUFSLENBQW5FLEVBQUUsc0NBQUYsRUFBbUIsc0NBQW5CLEVBQW9DLDBCQUFwQyxFQUErQzs7QUFFL0MsSUFBQSxHQUFPLE9BQUEsQ0FBUSxRQUFSOztBQUNQLElBQUEsR0FBTyxPQUFBLENBQVEsUUFBUjs7QUFFUCxHQUFBLEdBQU0sU0FBQyxDQUFELEVBQUcsQ0FBSCxFQUFLLENBQUw7V0FBVyxJQUFJLElBQUosQ0FBUyxDQUFULEVBQVksQ0FBWixFQUFlLENBQWY7QUFBWDs7QUFDTixJQUFBLEdBQU8sU0FBQyxDQUFELEVBQUksQ0FBSixFQUFPLENBQVAsRUFBVSxDQUFWO1dBQWdCLElBQUksSUFBSixDQUFTLENBQVQsRUFBWSxDQUFaLEVBQWUsQ0FBZixFQUFrQixDQUFsQjtBQUFoQjs7QUFFRDs7O0lBRUMsZ0JBQUMsS0FBRCxFQUFTLElBQVQsRUFBZSxNQUFmO1FBQUMsSUFBQyxDQUFBLFFBQUQ7Ozs7Ozs7Ozs7OztRQTRCQSx3Q0FBTSxRQUFOLEVBQWUsR0FBQSxDQUFJLENBQUosRUFBTSxDQUFOLEVBQVEsQ0FBQyxFQUFULENBQWYsRUFBNkIsSUFBQyxDQUFBLEtBQTlCO1FBR0EsSUFBQyxDQUFBLGFBQUQsQ0FBZSxNQUFmLEVBQXVCLEtBQXZCO1FBQ0EsSUFBQyxDQUFBLG9CQUFELEdBQXdCO1FBQ3hCLElBQUMsQ0FBQSxPQUFELEdBQVc7UUFDWCxJQUFDLENBQUEsS0FBRCxHQUFTO1FBRVQsSUFBQyxDQUFBLGdCQUFELEdBQW9CO1FBQ3BCLElBQUMsQ0FBQSxnQkFBRCxHQUFvQjtRQUVwQixJQUFDLENBQUEsa0JBQUQsR0FBc0I7UUFDdEIs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ICAgMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwIFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbjAwMCAgICAgICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMDAwXG4wMDAgICAgICAgMDAwICAgMDAwICAwMDAgMCAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcbiMjI1xuXG57IHJlZHVjZSwgY2xhbXAgfSA9IHJlcXVpcmUgJ2t4aydcbnsgVW5pdmVyc2FsQ2FtZXJhLCBBcmNSb3RhdGVDYW1lcmEsIEZseUNhbWVyYSwgRnJhbWluZ0JlaGF2aW9yIH0gPSByZXF1aXJlICdiYWJ5bG9uanMnXG5cblZlY3QgPSByZXF1aXJlICcuL3ZlY3QnXG5RdWF0ID0gcmVxdWlyZSAnLi9xdWF0J1xuXG52ZWMgPSAoeCx5LHopIC0+IG5ldyBWZWN0IHgsIHksIHpcbnF1YXQgPSAoeCwgeSwgeiwgdykgLT4gbmV3IFF1YXQgeCwgeSwgeiwgd1xuXG5jbGFzcyBDYW1lcmEgZXh0ZW5kcyBVbml2ZXJzYWxDYW1lcmFcblxuICAgIEA6IChAc2NlbmUsIHZpZXcsIGNhbnZhcykgLT5cbiAgICAgICAgXG4gICAgICAgICMgd2lkdGggID0gdmlldy5jbGllbnRXaWR0aFxuICAgICAgICAjIGhlaWdodCA9IHZpZXcuY2xpZW50SGVpZ2h0XG4gICAgICAgIFxuICAgICAgICAjIHN1cGVyIDcwIHdpZHRoL2hlaWdodCwgMC4wMSAzMDAgIyBmb3YsIGFzcGVjdCwgbmVhciwgZmFyXG4gICAgICAgIFxuICAgICAgICAjIEBzaXplICAgICAgID0gdmVjIHdpZHRoLCBoZWlnaHRcbiAgICAgICAgIyBAZWxlbSAgICAgICA9IHZpZXdcbiAgICAgICAgIyBAZGlzdCAgICAgICA9IDEwXG4gICAgICAgICMgQG1heERpc3QgICAgPSBAZmFyLzRcbiAgICAgICAgIyBAbWluRGlzdCAgICA9IDAuOVxuICAgICAgICAjIEBjZW50ZXIgICAgID0gdmVjIDAgMCAwXG4gICAgICAgICMgQGRlZ3JlZSAgICAgPSA2MFxuICAgICAgICAjIEByb3RhdGUgICAgID0gMFxuICAgICAgICAjIEB3aGVlbEluZXJ0ID0gMFxuICAgICAgICAjIEBwaXZvdFggICAgID0gMFxuICAgICAgICAjIEBwaXZvdFkgICAgID0gMFxuICAgICAgICAjIEBtb3ZlWCAgICAgID0gMFxuICAgICAgICAjIEBtb3ZlWSAgICAgID0gMFxuICAgICAgICAjIEBxdWF0ICAgICAgID0gcXVhdCgpXG5cbiAgICAgICAgIyBAZWxlbS5hZGRFdmVudExpc3RlbmVyICdtb3VzZXdoZWVsJyBAb25Nb3VzZVdoZWVsXG4gICAgICAgICMgQGVsZW0uYWRkRXZlbnRMaXN0ZW5lciAnbW91c2Vkb3duJyAgQG9uTW91c2VEb3duXG4gICAgICAgICMgQGVsZW0uYWRkRXZlbnRMaXN0ZW5lciAna2V5cHJlc3MnICAgQG9uS2V5UHJlc3NcbiAgICAgICAgIyBAZWxlbS5hZGRFdmVudExpc3RlbmVyICdrZXlyZWxlYXNlJyBAb25LZXlSZWxlYXNlXG4gICAgICAgICMgQGVsZW0uYWRkRXZlbnRMaXN0ZW5lciAnZGJsY2xpY2snICAgQG9uRGJsQ2xpY2tcbiAgICAgICAgXG4gICAgICAgIHN1cGVyICdDYW1lcmEnIHZlYygwIDAgLTEwKSwgQHNjZW5lXG4gICAgICAgICMgc3VwZXIgJ0NhbWVyYScgMCAwIDAgVmVjdC5aZXJvKCksIEBzY2VuZVxuICAgICAgICBcbiAgICAgICAgQGF0dGFjaENvbnRyb2wgY2FudmFzLCBmYWxzZVxuICAgICAgICBAd2hlZWxEZWx0YVBlcmNlbnRhZ2UgPSAwLjAyXG4gICAgICAgIEBpbmVydGlhID0gMC43XG4gICAgICAgIEBzcGVlZCA9IDFcbiAgICAgICAgXG4gICAgICAgIEBsb3dlclJhZGl1c0xpbWl0ID0gMlxuICAgICAgICBAdXBwZXJSYWRpdXNMaW1pdCA9IDEwMFxuICAgICAgICAjIEBzZXRQb3NpdGlvbiB2ZWMgMCAwIC00MFxuICAgICAgICBAdXNlRnJhbWluZ0JlaGF2aW9yID0gdHJ1ZVxuICAgICAgICBGcmFtaW5nQmVoYXZpb3IubW9kZSA9IEZyYW1pbmdCZWhhdmlvci5GaXRGcnVzdHVtU2lkZXNNb2RlXG4gICAgICAgIEZyYW1pbmdCZWhhdmlvci5yYWRpdXNTY2FsZSA9IDRcbiAgICAgICAgXG4gICAgICAgICMgQHVwZGF0ZSgpXG5cbiAgICAjIGdldFBvc2l0aW9uOiAtPiB2ZWMgQGdldEZyb250UG9zaXRpb24gMFxuICAgICMgZ2V0RGlyOiAgICAgIC0+IHF1YXQoQHJvdGF0aW9uUXVhdGVybmlvbikucm90YXRlIFZlY3QubWludXNaXG4gICAgIyBnZXRVcDogICAgICAgLT4gcXVhdChAcm90YXRpb25RdWF0ZXJuaW9uKS5yb3RhdGUgVmVjdC51bml0WVxuICAgICMgZ2V0UmlnaHQ6ICAgIC0+IHF1YXQoQHJvdGF0aW9uUXVhdGVybmlvbikucm90YXRlIFZlY3QudW5pdFhcblxuICAgIGRlbDogPT5cbiAgICAgICAgXG4gICAgICAgIEBlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIgICdrZXlwcmVzcycgICBAb25LZXlQcmVzc1xuICAgICAgICBAZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICAna2V5cmVsZWFzZScgQG9uS2V5UmVsZWFzZVxuICAgICAgICBAZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICAnbW91c2V3aGVlbCcgQG9uTW91c2VXaGVlbFxuICAgICAgICBAZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICAnbW91c2Vkb3duJyAgQG9uTW91c2VEb3duXG4gICAgICAgIEBlbGVtLnJlbW92ZUV2ZW50TGlzdGVuZXIgICdkYmxjbGljaycgICBAb25EYmxDbGlja1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciAnbW91c2V1cCcgICAgQG9uTW91c2VVcFxuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciAnbW91c2Vtb3ZlJyAgQG9uTW91c2VEcmFnIFxuICAgICAgICBcbiAgICAjIDAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuICAgIFxuICAgIG9uTW91c2VEb3duOiAoZXZlbnQpID0+IFxuICAgICAgICBcbiAgICAgICAgQGRvd25CdXR0b25zID0gZXZlbnQuYnV0dG9uc1xuICAgICAgICBAbW91c2VNb3ZlZCAgPSBmYWxzZVxuICAgICAgICAgICAgXG4gICAgICAgIEBtb3VzZVggPSBldmVudC5jbGllbnRYXG4gICAgICAgIEBtb3VzZVkgPSBldmVudC5jbGllbnRZXG4gICAgICAgIFxuICAgICAgICBAZG93blBvcyA9IHZlYyBAbW91c2VYLCBAbW91c2VZXG4gICAgICAgIFxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAnbW91c2Vtb3ZlJyBAb25Nb3VzZURyYWdcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgJ21vdXNldXAnICAgQG9uTW91c2VVcFxuICAgICAgICBcbiAgICBvbk1vdXNlVXA6IChldmVudCkgPT4gXG5cbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIgJ21vdXNlbW92ZScgQG9uTW91c2VEcmFnXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyICdtb3VzZXVwJyAgIEBvbk1vdXNlVXBcbiAgICAgICAgXG4gICAgb25EYmxDbGljazogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICBvbk1vdXNlRHJhZzogKGV2ZW50KSA9PlxuXG4gICAgICAgIHggPSBldmVudC5jbGllbnRYLUBtb3VzZVhcbiAgICAgICAgeSA9IGV2ZW50LmNsaWVudFktQG1vdXNlWVxuICAgICAgICBcbiAgICAgICAgQG1vdXNlWCA9IGV2ZW50LmNsaWVudFhcbiAgICAgICAgQG1vdXNlWSA9IGV2ZW50LmNsaWVudFlcbiAgICAgICAgXG4gICAgICAgIGlmIEBkb3duUG9zLmRpc3QodmVjIEBtb3VzZVgsIEBtb3VzZVkpID4gNjBcbiAgICAgICAgICAgIEBtb3VzZU1vdmVkID0gdHJ1ZVxuICAgICAgICBcbiAgICAgICAgaWYgZXZlbnQuYnV0dG9ucyAmIDRcbiAgICAgICAgICAgIHMgPSBAZGlzdFxuICAgICAgICAgICAgQHBhbiB4KjIqcy9Ac2l6ZS54LCB5KnMvQHNpemUueVxuICAgICAgICAgICAgXG4gICAgICAgIGlmIGV2ZW50LmJ1dHRvbnMgJiAyXG4gICAgICAgICAgICBAcGl2b3QgNDAwMCp4L0BzaXplLngsIDIwMDAqeS9Ac2l6ZS55XG4gICAgICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwICAgMDAwIDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAgMDAwICAgICAgMCAgICAgICAwMDAwMDAwICAgICAgMDAwICAgICBcbiAgICBcbiAgICBwaXZvdDogKHgseSkgLT5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQHJvdGF0ZSArPSAtMC4xKnhcbiAgICAgICAgQGRlZ3JlZSArPSAtMC4xKnlcbiAgICAgICAgXG4gICAgICAgIEB1cGRhdGUoKVxuICAgICAgICAgICBcbiAgICBzdGFydFBpdm90TGVmdDogLT5cbiAgICAgICAgXG4gICAgICAgIEBwaXZvdFggPSAyMFxuICAgICAgICBAc3RhcnRQaXZvdCgpXG4gICAgICAgIFxuICAgIHN0YXJ0UGl2b3RSaWdodDogLT5cbiAgICAgICAgXG4gICAgICAgIEBwaXZvdFggPSAtMjBcbiAgICAgICAgQHN0YXJ0UGl2b3QoKVxuXG4gICAgc3RhcnRQaXZvdFVwOiAtPlxuICAgICAgICBcbiAgICAgICAgQHBpdm90WSA9IC0xMFxuICAgICAgICBAc3RhcnRQaXZvdCgpXG4gICAgICAgIFxuICAgIHN0YXJ0UGl2b3REb3duOiAtPlxuICAgICAgICBcbiAgICAgICAgQHBpdm90WSA9IDEwXG4gICAgICAgIEBzdGFydFBpdm90KClcbiAgICAgICAgXG4gICAgc3RvcFBpdm90OiAtPlxuICAgICAgICBcbiAgICAgICAgQHBpdm90aW5nID0gZmFsc2VcbiAgICAgICAgQHBpdm90WCA9IDBcbiAgICAgICAgQHBpdm90WSA9IDBcbiAgICAgICBcbiAgICBzdGFydFBpdm90OiAtPiBcbiAgICAgICAgXG4gICAgICAgIGlmIG5vdCBAcGl2b3RpbmdcbiAgICAgICAgICAgICMgcnRzLmFuaW1hdGUgQHBpdm90Q2VudGVyXG4gICAgICAgICAgICBAcGl2b3RpbmcgPSB0cnVlXG4gICAgICAgICAgICBcbiAgICBwaXZvdENlbnRlcjogKGRlbHRhU2Vjb25kcykgPT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBub3QgQHBpdm90aW5nXG5cbiAgICAgICAgQHBpdm90IEBwaXZvdFgsIEBwaXZvdFlcbiAgICAgICAgXG4gICAgICAgICMgcnRzLmFuaW1hdGUgQHBpdm90Q2VudGVyXG4gICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAgMCAwMDAgIFxuICAgICMgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgXG4gICAgIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICBcbiAgICBwYW46ICh4LHkpIC0+XG4gICAgICAgIFxuICAgICAgICByaWdodCA9IHZlYyAteCwgMCwgMCBcbiAgICAgICAgcmlnaHQuYXBwbHlRdWF0ZXJuaW9uIEByb3RhdGlvblF1YXRlcm5pb25cblxuICAgICAgICB1cCA9IHZlYyAwLCB5LCAwIFxuICAgICAgICB1cC5hcHBseVF1YXRlcm5pb24gQHJvdGF0aW9uUXVhdGVybmlvblxuICAgICAgICBcbiAgICAgICAgQGNlbnRlci5hZGQgcmlnaHQuYWRkIHVwXG4gICAgICAgIEBjZW50ZXJUYXJnZXQ/LmNvcHkgQGNlbnRlclxuICAgICAgICBAdXBkYXRlKClcbiAgICAgICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuICAgICMgMDAwICAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgICAgICAgICAgICAgICAgICAgXG4gICAgZm9jdXNPblBvczogKHYpIC0+XG4gICAgICAgIFxuICAgICAgICBAY2VudGVyVGFyZ2V0ID0gdmVjIHZcbiAgICAgICAgQGNlbnRlciA9IHZlYyB2XG4gICAgICAgIEB1cGRhdGUoKVxuICAgICAgICAgXG4gICAgZmFkZVRvUG9zOiAodikgLT4gXG4gICAgICAgIFxuICAgICAgICBAY2VudGVyVGFyZ2V0ID0gdmVjIHZcbiAgICAgICAgQHN0YXJ0RmFkZUNlbnRlcigpXG5cbiAgICBzdGFydEZhZGVDZW50ZXI6IC0+IFxuICAgICAgICBcbiAgICAgICAgaWYgbm90IEBmYWRpbmdcbiAgICAgICAgICAgICMgcnRzLmFuaW1hdGUgQGZhZGVDZW50ZXJcbiAgICAgICAgICAgIEBmYWRpbmcgPSB0cnVlXG4gICAgICAgICAgICBcbiAgICBmYWRlQ2VudGVyOiAoZGVsdGFTZWNvbmRzKSA9PlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIG5vdCBAZmFkaW5nXG4gICAgICAgIFxuICAgICAgICBAY2VudGVyLmZhZGUgQGNlbnRlclRhcmdldCwgZGVsdGFTZWNvbmRzXG4gICAgICAgIEB1cGRhdGUoKVxuICAgICAgICBcbiAgICAgICAgaWYgQGNlbnRlci5kaXN0KEBjZW50ZXJUYXJnZXQpID4gMC4wMDAwMVxuICAgICAgICAgICAgIyBydHMuYW5pbWF0ZSBAZmFkZUNlbnRlclxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBkZWxldGUgQGZhZGluZ1xuXG4gICAgIyAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMCAwMDAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgICAwMDAwMDAwICAgICAgIDAgICAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgbW92ZUZhY3RvcjogLT4gQGRpc3QvMlxuICAgIFxuICAgIHN0YXJ0TW92ZUxlZnQ6IC0+XG4gICAgICAgIFxuICAgICAgICBAbW92ZVggPSAtQG1vdmVGYWN0b3IoKVxuICAgICAgICBAc3RhcnRNb3ZlKClcbiAgICAgICAgXG4gICAgc3RhcnRNb3ZlUmlnaHQ6IC0+XG4gICAgICAgIFxuICAgICAgICBAbW92ZVggPSBAbW92ZUZhY3RvcigpXG4gICAgICAgIEBzdGFydE1vdmUoKVxuXG4gICAgc3RhcnRNb3ZlVXA6IC0+XG4gICAgICAgIFxuICAgICAgICBAbW92ZVkgPSBAbW92ZUZhY3RvcigpXG4gICAgICAgIEBzdGFydE1vdmUoKVxuICAgICAgICBcbiAgICBzdGFydE1vdmVEb3duOiAtPlxuICAgICAgICBcbiAgICAgICAgQG1vdmVZID0gLUBtb3ZlRmFjdG9yKClcbiAgICAgICAgQHN0YXJ0TW92ZSgpXG4gICAgICAgIFxuICAgIHN0b3BNb3Zpbmc6IC0+XG4gICAgICAgIFxuICAgICAgICBAbW92aW5nID0gZmFsc2VcbiAgICAgICAgQG1vdmVYID0gMFxuICAgICAgICBAbW92ZVkgPSAwXG4gICAgICAgXG4gICAgc3RhcnRNb3ZlOiAtPiBcbiAgICAgICAgXG4gICAgICAgIEBmYWRpbmcgPSBmYWxzZVxuICAgICAgICBpZiBub3QgQG1vdmluZ1xuICAgICAgICAgICAgcnRzLmFuaW1hdGUgQG1vdmVDZW50ZXJcbiAgICAgICAgICAgIEBtb3ZpbmcgPSB0cnVlXG4gICAgICAgICAgICBcbiAgICBtb3ZlQ2VudGVyOiAoZGVsdGFTZWNvbmRzKSA9PlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIG5vdCBAbW92aW5nXG4gICAgICAgIFxuICAgICAgICBkaXIgPSB2ZWMoKVxuICAgICAgICBkaXIuYWRkIFZlY3QudW5pdFgubXVsIEBtb3ZlWFxuICAgICAgICBkaXIuYWRkIFZlY3QudW5pdFkubXVsIEBtb3ZlWVxuICAgICAgICBkaXIuc2NhbGUgZGVsdGFTZWNvbmRzXG4gICAgICAgIGRpci5hcHBseVF1YXRlcm5pb24gQHJvdGF0aW9uUXVhdGVybmlvblxuICAgICAgICBcbiAgICAgICAgQGNlbnRlci5hZGQgZGlyXG4gICAgICAgIEB1cGRhdGUoKVxuICAgICAgICBcbiAgICAgICAgcnRzLmFuaW1hdGUgQG1vdmVDZW50ZXJcbiAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgIFxuICAgICMgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICBcbiAgICAjIDAwICAgICAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgIFxuICAgIFxuICAgIG9uTW91c2VXaGVlbDogKGV2ZW50KSA9PiBcbiAgICBcbiAgICAgICAgaWYgQHdoZWVsSW5lcnQgPiAwIGFuZCBldmVudC53aGVlbERlbHRhIDwgMFxuICAgICAgICAgICAgQHdoZWVsSW5lcnQgPSAwXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIFxuICAgICAgICBpZiBAd2hlZWxJbmVydCA8IDAgYW5kIGV2ZW50LndoZWVsRGVsdGEgPiAwXG4gICAgICAgICAgICBAd2hlZWxJbmVydCA9IDBcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgXG4gICAgICAgIEB3aGVlbEluZXJ0ICs9IGV2ZW50LndoZWVsRGVsdGEgKiAoMSsoQGRpc3QvQG1heERpc3QpKjMpICogMC4wMDAxXG4gICAgICAgIFxuICAgICAgICBAc3RhcnRab29tKClcblxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwICAgICAwMCAgXG4gICAgIyAgICAwMDAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjICAgMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIFxuICAgICMgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwICBcblxuICAgIHN0YXJ0Wm9vbUluOiAtPlxuICAgICAgICBcbiAgICAgICAgQHdoZWVsSW5lcnQgPSAoMSsoQGRpc3QvQG1heERpc3QpKjMpKjEwXG4gICAgICAgIEBzdGFydFpvb20oKVxuICAgICAgICBcbiAgICBzdGFydFpvb21PdXQ6IC0+XG4gICAgICAgIFxuICAgICAgICBAd2hlZWxJbmVydCA9IC0oMSsoQGRpc3QvQG1heERpc3QpKjMpKjEwXG4gICAgICAgIEBzdGFydFpvb20oKVxuICAgIFxuICAgIHN0YXJ0Wm9vbTogLT4gXG4gICAgICAgIFxuICAgICAgICBpZiBub3QgQHpvb21pbmdcbiAgICAgICAgICAgICMgcnRzLmFuaW1hdGUgQGluZXJ0Wm9vbVxuICAgICAgICAgICAgQHpvb21pbmcgPSB0cnVlXG4gICAgICAgICAgICBcbiAgICBzdG9wWm9vbTogLT4gXG4gICAgICAgIFxuICAgICAgICBAd2hlZWxJbmVydCA9IDBcbiAgICAgICAgQHpvb21pbmcgPSBmYWxzZVxuICAgIFxuICAgIGluZXJ0Wm9vbTogKGRlbHRhU2Vjb25kcykgPT5cblxuICAgICAgICBAc2V0RGlzdEZhY3RvciAxIC0gY2xhbXAgLTAuMDIgMC4wMiBAd2hlZWxJbmVydFxuICAgICAgICBAd2hlZWxJbmVydCA9IHJlZHVjZSBAd2hlZWxJbmVydCwgZGVsdGFTZWNvbmRzKjAuM1xuICAgICAgICBcbiAgICAgICAgaWYgTWF0aC5hYnMoQHdoZWVsSW5lcnQpID4gMC4wMDAwMDAwMVxuICAgICAgICAgICAgIyBydHMuYW5pbWF0ZSBAaW5lcnRab29tXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGRlbGV0ZSBAem9vbWluZ1xuICAgICAgICAgICAgQHdoZWVsSW5lcnQgPSAwXG4gICAgXG4gICAgc2V0RGlzdEZhY3RvcjogKGZhY3RvcikgPT5cbiAgICAgICAgXG4gICAgICAgIEBkaXN0ID0gY2xhbXAgQG1pbkRpc3QsIEBtYXhEaXN0LCBAZGlzdCpmYWN0b3JcbiAgICAgICAgQHVwZGF0ZSgpXG4gICAgICAgIFxuICAgIHNldEZvdjogKGZvdikgLT4gQGZvdiA9IE1hdGgubWF4KDIuMCBNYXRoLm1pbiBmb3YsIDE3NS4wKVxuICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjICAwMDAwMDAwICAgMDAwICAgICAgICAwMDAwMDAwICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAwMDAwMCAgXG4gICAgXG4gICAgIyB1cGRhdGU6IC0+IFxuIyAgICAgICAgIFxuICAgICAgICAjIEBkZWdyZWUgPSBjbGFtcCAwIDE4MCBAZGVncmVlXG4gICAgICAgIFxuICAgICAgICAjIEBxdWF0LnJlc2V0KClcbiAgICAgICAgIyBAcXVhdC5yb3RhdGVBeGlzQW5nbGUgVmVjdC51bml0WiwgQHJvdGF0ZVxuICAgICAgICAjIEBxdWF0LnJvdGF0ZUF4aXNBbmdsZSBWZWN0LnVuaXRYLCBAZGVncmVlXG4gICAgICAgIFxuICAgICAgICAjIEBwb3NpdGlvbi5jb3B5IEBjZW50ZXIucGx1cyB2ZWMoMCAwIEBkaXN0KS5hcHBseVF1YXRlcm5pb24gQHF1YXRcbiAgICAgICAgIyBAcm90YXRpb25RdWF0ZXJuaW9uLmNvcHkgQHF1YXRcbiAgICAgICAgXG4gICAgICAgICMgbG9nIFwiY2FtZXJhOlwiLCBAZGlzdCwgQHJvdGF0ZSwgQGRlZ3JlZVxuXG5tb2R1bGUuZXhwb3J0cyA9IENhbWVyYVxuIl19
//# sourceURL=../coffee/camera.coffee