// koffee 1.6.0

/*
 0000000   0000000   00     00  00000000  00000000    0000000 
000       000   000  000   000  000       000   000  000   000
000       000000000  000000000  0000000   0000000    000000000
000       000   000  000 0 000  000       000   000  000   000
 0000000  000   000  000   000  00000000  000   000  000   000
 */
var Camera, PointLight, Quat, TargetCamera, UniversalCamera, Vect, animate, clamp, deg2rad, quat, reduce, ref, ref1, vec,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

ref = require('kxk'), deg2rad = ref.deg2rad, reduce = ref.reduce, clamp = ref.clamp;

ref1 = require('babylonjs'), TargetCamera = ref1.TargetCamera, UniversalCamera = ref1.UniversalCamera, PointLight = ref1.PointLight;

Vect = require('./vect');

Quat = require('./quat');

animate = require('./animate');

vec = function(x, y, z) {
    return new Vect(x, y, z);
};

quat = function(x, y, z, w) {
    return new Quat(x, y, z, w);
};

Camera = (function(superClass) {
    extend(Camera, superClass);

    function Camera(scene, view, canvas) {
        var height, width;
        this.scene = scene;
        this.view = view;
        this.canvas = canvas;
        this.setDist = bind(this.setDist, this);
        this.inertZoom = bind(this.inertZoom, this);
        this.onMouseWheel = bind(this.onMouseWheel, this);
        this.moveCenter = bind(this.moveCenter, this);
        this.fadeCenter = bind(this.fadeCenter, this);
        this.onMouseDrag = bind(this.onMouseDrag, this);
        this.onMouseUp = bind(this.onMouseUp, this);
        this.onMouseDown = bind(this.onMouseDown, this);
        this.del = bind(this.del, this);
        width = this.view.clientWidth;
        height = this.view.clientHeight;
        this.size = vec(width, height);
        this.dist = 10;
        this.maxDist = 100;
        this.minDist = 3;
        this.center = vec(10.5, 3, 6);
        this.moveFade = vec(0, 0, 0);
        this.degree = 90;
        this.rotate = 0;
        this.wheelInert = 0;
        this.pivotX = 0;
        this.pivotY = 0;
        this.moveX = 0;
        this.moveY = 0;
        this.moveZ = 0;
        this.quat = quat();
        Camera.__super__.constructor.call(this, 'Camera', vec(0, -10, 0), this.scene);
        this.rotationQuaternion = new Quat();
        this.setTarget(this.center);
        this.inertia = 0.8;
        this.light = new PointLight('spot', this.position, this.scene);
        this.light.intensity = 0.5;
        this.view.addEventListener('mousewheel', this.onMouseWheel);
        this.navigate();
    }

    Camera.prototype.getDir = function() {
        return this.rotationQuaternion.rotated(Vect.unitZ);
    };

    Camera.prototype.getUp = function() {
        return this.rotationQuaternion.rotated(Vect.unitY);
    };

    Camera.prototype.getRight = function() {
        return this.rotationQuaternion.rotated(Vect.unitX);
    };

    Camera.prototype.setCenter = function(p) {
        this.center = vec(p);
        return this.navigate();
    };

    Camera.prototype.del = function() {
        return this.view.removeEventListener('mousewheel', this.onMouseWheel);
    };

    Camera.prototype.onMouseDown = function(event) {
        this.downButtons = event.buttons;
        this.mouseMoved = false;
        this.mouseX = event.clientX;
        this.mouseY = event.clientY;
        return this.downPos = vec(this.mouseX, this.mouseY);
    };

    Camera.prototype.onMouseUp = function(event) {};

    Camera.prototype.onMouseDrag = function(event) {
        var ref2, s, x, y;
        x = event.clientX - this.mouseX;
        y = event.clientY - this.mouseY;
        this.mouseX = event.clientX;
        this.mouseY = event.clientY;
        if (((ref2 = this.downPos) != null ? ref2.dist(vec(this.mouseX, this.mouseY)) : void 0) > 60) {
            this.mouseMoved = true;
        }
        if (event.buttons & 4) {
            s = this.dist;
            this.pan(x * 2 * s / this.size.x, y * s / this.size.y);
        }
        if (event.buttons & 3) {
            return this.pivot(4000 * x / this.size.x, 2000 * y / this.size.y);
        }
    };

    Camera.prototype.pivot = function(x, y) {
        this.rotate += 0.1 * x;
        this.degree += 0.1 * y;
        return this.navigate();
    };

    Camera.prototype.pan = function(x, y) {
        var ref2, right, up;
        right = vec(-x, 0, 0);
        right.applyQuaternion(this.rotationQuaternion);
        up = vec(0, y, 0);
        up.applyQuaternion(this.rotationQuaternion);
        this.center.add(right.plus(up));
        if ((ref2 = this.centerTarget) != null) {
            ref2.copy(this.center);
        }
        return this.navigate();
    };

    Camera.prototype.fadeToPos = function(v) {
        this.centerTarget = vec(v);
        return this.startFadeCenter();
    };

    Camera.prototype.startFadeCenter = function() {
        if (!this.fading) {
            animate(this.fadeCenter);
            return this.fading = true;
        }
    };

    Camera.prototype.fadeCenter = function(deltaSeconds) {
        if (!this.fading) {
            return;
        }
        this.center.fade(this.centerTarget, deltaSeconds);
        this.navigate();
        if (this.center.dist(this.centerTarget) > 0.00001) {
            animate(this.fadeCenter);
            return true;
        } else {
            return delete this.fading;
        }
    };

    Camera.prototype.moveForward = function() {
        return this.startMove(this.moveZ = 1);
    };

    Camera.prototype.moveRight = function() {
        return this.startMove(this.moveX = 1);
    };

    Camera.prototype.moveUp = function() {
        return this.startMove(this.moveY = 1);
    };

    Camera.prototype.moveLeft = function() {
        return this.startMove(this.moveX = -1);
    };

    Camera.prototype.moveDown = function() {
        return this.startMove(this.moveY = -1);
    };

    Camera.prototype.moveBackward = function() {
        return this.startMove(this.moveZ = -1);
    };

    Camera.prototype.stopRight = function() {
        return this.moveX = clamp(-1, 0, this.moveX);
    };

    Camera.prototype.stopLeft = function() {
        return this.moveX = clamp(0, 1, this.moveX);
    };

    Camera.prototype.stopUp = function() {
        return this.moveY = clamp(-1, 0, this.moveY);
    };

    Camera.prototype.stopDown = function() {
        return this.moveY = clamp(0, 1, this.moveY);
    };

    Camera.prototype.stopForward = function() {
        return this.moveZ = clamp(-1, 0, this.moveZ);
    };

    Camera.prototype.stopBackward = function() {
        return this.moveZ = clamp(0, 1, this.moveZ);
    };

    Camera.prototype.stopMoving = function() {
        this.moving = false;
        this.moveX = 0;
        this.moveY = 0;
        return this.moveZ = 0;
    };

    Camera.prototype.startMove = function() {
        this.fading = false;
        if (!this.moving) {
            this.dist = this.minDist;
            this.center = this.position.plus(this.getDir().mul(this.dist));
            animate(this.moveCenter);
            return this.moving = true;
        }
    };

    Camera.prototype.moveCenter = function(deltaSeconds) {
        var dir;
        if (!this.moving) {
            return;
        }
        dir = vec();
        dir.add(Vect.unitX.mul(10 * (this.moveX || this.moveFade.x)));
        dir.add(Vect.unitY.mul(10 * (this.moveY || this.moveFade.y)));
        dir.add(Vect.unitZ.mul(10 * (this.moveZ || this.moveFade.z)));
        dir.scale(deltaSeconds);
        this.rotationQuaternion.rotate(dir);
        this.center.add(dir);
        this.navigate();
        this.moveFade.x = this.moveX || reduce(this.moveFade.x, deltaSeconds);
        this.moveFade.y = this.moveY || reduce(this.moveFade.y, deltaSeconds);
        this.moveFade.z = this.moveZ || reduce(this.moveFade.z, deltaSeconds);
        if (this.moveFade.length() > 0.001) {
            return animate(this.moveCenter);
        } else {
            return this.stopMoving();
        }
    };

    Camera.prototype.onMouseWheel = function(event) {
        if (this.wheelInert > 0 && event.wheelDelta < 0) {
            this.wheelInert = 0;
            return;
        }
        if (this.wheelInert < 0 && event.wheelDelta > 0) {
            this.wheelInert = 0;
            return;
        }
        this.wheelInert += event.wheelDelta * (1 + (this.dist / this.maxDist) * 3) * 0.0001;
        return this.startZoom();
    };

    Camera.prototype.startZoomIn = function() {
        this.wheelInert = (1 + (this.dist / this.maxDist) * 3) * 10;
        return this.startZoom();
    };

    Camera.prototype.startZoomOut = function() {
        this.wheelInert = -(1 + (this.dist / this.maxDist) * 3) * 10;
        return this.startZoom();
    };

    Camera.prototype.startZoom = function() {
        if (!this.zooming) {
            animate(this.inertZoom);
            return this.zooming = true;
        }
    };

    Camera.prototype.stopZoom = function() {
        this.wheelInert = 0;
        return this.zooming = false;
    };

    Camera.prototype.inertZoom = function(deltaSeconds) {
        this.setDist(1 - clamp(-0.02, 0.02, this.wheelInert));
        this.wheelInert = reduce(this.wheelInert, deltaSeconds * 0.2);
        if (Math.abs(this.wheelInert) > 0.00000001) {
            animate(this.inertZoom);
            return true;
        } else {
            delete this.zooming;
            return this.wheelInert = 0;
        }
    };

    Camera.prototype.setDist = function(factor) {
        this.dist = clamp(this.minDist, this.maxDist, this.dist * factor);
        return this.navigate();
    };

    Camera.prototype.setFov = function(fov) {
        return this.fov = Math.max(2.0, Math.min(fov, 175.0));
    };

    Camera.prototype.navigate = function() {
        var pitch, yaw;
        this.degree = clamp(1, 179, this.degree);
        yaw = deg2rad(this.rotate);
        pitch = deg2rad(this.degree);
        this.rotationQuaternion.copyFrom(Quat.RotationYawPitchRoll(yaw, pitch, 0));
        this.position.copyFrom(this.center.plus(this.rotationQuaternion.rotate(vec(0, 0 - this.dist))));
        this.setTarget(this.center);
        if (18 * this.minDist / this.dist >= 8) {
            return this.scene.style.fontSize = 18 * this.minDist / this.dist;
        } else {
            return this.scene.style.fontSize = 0;
        }
    };

    return Camera;

})(UniversalCamera);

module.exports = Camera;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FtZXJhLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxvSEFBQTtJQUFBOzs7O0FBUUEsTUFBNkIsT0FBQSxDQUFRLEtBQVIsQ0FBN0IsRUFBRSxxQkFBRixFQUFXLG1CQUFYLEVBQW1COztBQUNuQixPQUFnRCxPQUFBLENBQVEsV0FBUixDQUFoRCxFQUFFLGdDQUFGLEVBQWdCLHNDQUFoQixFQUFpQzs7QUFFakMsSUFBQSxHQUFPLE9BQUEsQ0FBUSxRQUFSOztBQUNQLElBQUEsR0FBTyxPQUFBLENBQVEsUUFBUjs7QUFFUCxPQUFBLEdBQVUsT0FBQSxDQUFRLFdBQVI7O0FBRVYsR0FBQSxHQUFNLFNBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMO1dBQVcsSUFBSSxJQUFKLENBQVMsQ0FBVCxFQUFZLENBQVosRUFBZSxDQUFmO0FBQVg7O0FBQ04sSUFBQSxHQUFPLFNBQUMsQ0FBRCxFQUFHLENBQUgsRUFBSyxDQUFMLEVBQU8sQ0FBUDtXQUFhLElBQUksSUFBSixDQUFTLENBQVQsRUFBWSxDQUFaLEVBQWUsQ0FBZixFQUFrQixDQUFsQjtBQUFiOztBQUVEOzs7SUFFQyxnQkFBQyxLQUFELEVBQVMsSUFBVCxFQUFnQixNQUFoQjtBQUVDLFlBQUE7UUFGQSxJQUFDLENBQUEsUUFBRDtRQUFRLElBQUMsQ0FBQSxPQUFEO1FBQU8sSUFBQyxDQUFBLFNBQUQ7Ozs7Ozs7Ozs7UUFFZixLQUFBLEdBQVMsSUFBQyxDQUFBLElBQUksQ0FBQztRQUNmLE1BQUEsR0FBUyxJQUFDLENBQUEsSUFBSSxDQUFDO1FBRWYsSUFBQyxDQUFBLElBQUQsR0FBYyxHQUFBLENBQUksS0FBSixFQUFXLE1BQVg7UUFDZCxJQUFDLENBQUEsSUFBRCxHQUFjO1FBQ2QsSUFBQyxDQUFBLE9BQUQsR0FBYztRQUNkLElBQUMsQ0FBQSxPQUFELEdBQWM7UUFDZCxJQUFDLENBQUEsTUFBRCxHQUFj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dXJjZXNDb250ZW50IjpbIiMjI1xuIDAwMDAwMDAgICAwMDAwMDAwICAgMDAgICAgIDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCBcbjAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4wMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAwMFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4jIyNcblxueyBkZWcycmFkLCByZWR1Y2UsIGNsYW1wIH0gPSByZXF1aXJlICdreGsnXG57IFRhcmdldENhbWVyYSwgVW5pdmVyc2FsQ2FtZXJhLCBQb2ludExpZ2h0IH0gPSByZXF1aXJlICdiYWJ5bG9uanMnXG5cblZlY3QgPSByZXF1aXJlICcuL3ZlY3QnXG5RdWF0ID0gcmVxdWlyZSAnLi9xdWF0J1xuXG5hbmltYXRlID0gcmVxdWlyZSAnLi9hbmltYXRlJ1xuXG52ZWMgPSAoeCx5LHopIC0+IG5ldyBWZWN0IHgsIHksIHpcbnF1YXQgPSAoeCx5LHosdykgLT4gbmV3IFF1YXQgeCwgeSwgeiwgd1xuXG5jbGFzcyBDYW1lcmEgZXh0ZW5kcyBVbml2ZXJzYWxDYW1lcmFcblxuICAgIEA6IChAc2NlbmUsIEB2aWV3LCBAY2FudmFzKSAtPlxuICAgICAgICBcbiAgICAgICAgd2lkdGggID0gQHZpZXcuY2xpZW50V2lkdGhcbiAgICAgICAgaGVpZ2h0ID0gQHZpZXcuY2xpZW50SGVpZ2h0XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIEBzaXplICAgICAgID0gdmVjIHdpZHRoLCBoZWlnaHRcbiAgICAgICAgQGRpc3QgICAgICAgPSAxMFxuICAgICAgICBAbWF4RGlzdCAgICA9IDEwMFxuICAgICAgICBAbWluRGlzdCAgICA9IDNcbiAgICAgICAgQGNlbnRlciAgICAgPSB2ZWMgMTAuNSAzIDZcbiAgICAgICAgQG1vdmVGYWRlICAgPSB2ZWMgMCAwIDBcbiAgICAgICAgQGRlZ3JlZSAgICAgPSA5MFxuICAgICAgICBAcm90YXRlICAgICA9IDBcbiAgICAgICAgQHdoZWVsSW5lcnQgPSAwXG4gICAgICAgIEBwaXZvdFggICAgID0gMFxuICAgICAgICBAcGl2b3RZICAgICA9IDBcbiAgICAgICAgQG1vdmVYICAgICAgPSAwXG4gICAgICAgIEBtb3ZlWSAgICAgID0gMFxuICAgICAgICBAbW92ZVogICAgICA9IDBcbiAgICAgICAgQHF1YXQgICAgICAgPSBxdWF0KClcblxuICAgICAgICBzdXBlciAnQ2FtZXJhJyB2ZWMoMCAtMTAgMCksIEBzY2VuZVxuXG4gICAgICAgIEByb3RhdGlvblF1YXRlcm5pb24gPSBuZXcgUXVhdCgpXG4gICAgICAgIEBzZXRUYXJnZXQgQGNlbnRlclxuICAgICAgICAgICAgICAgIFxuICAgICAgICBAaW5lcnRpYSA9IDAuOFxuICAgICAgICBcbiAgICAgICAgQGxpZ2h0ID0gbmV3IFBvaW50TGlnaHQgJ3Nwb3QnIEBwb3NpdGlvbiwgQHNjZW5lXG4gICAgICAgIEBsaWdodC5pbnRlbnNpdHkgPSAwLjVcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICBAdmlldy5hZGRFdmVudExpc3RlbmVyICdtb3VzZXdoZWVsJyBAb25Nb3VzZVdoZWVsXG4gICAgICAgIEBuYXZpZ2F0ZSgpXG5cbiAgICBnZXREaXI6ICAgIC0+IEByb3RhdGlvblF1YXRlcm5pb24ucm90YXRlZCBWZWN0LnVuaXRaXG4gICAgZ2V0VXA6ICAgICAtPiBAcm90YXRpb25RdWF0ZXJuaW9uLnJvdGF0ZWQgVmVjdC51bml0WVxuICAgIGdldFJpZ2h0OiAgLT4gQHJvdGF0aW9uUXVhdGVybmlvbi5yb3RhdGVkIFZlY3QudW5pdFhcblxuICAgIHNldENlbnRlcjogKHApIC0+XG5cbiAgICAgICAgQGNlbnRlciA9IHZlYyBwXG4gICAgICAgIEBuYXZpZ2F0ZSgpXG4gICAgXG4gICAgZGVsOiA9PlxuICAgICAgICBcbiAgICAgICAgQHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lciAgJ21vdXNld2hlZWwnIEBvbk1vdXNlV2hlZWxcbiAgICAgICAgXG4gICAgIyAwMCAgICAgMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBvbk1vdXNlRG93bjogKGV2ZW50KSA9PiBcbiAgICAgICAgXG4gICAgICAgIEBkb3duQnV0dG9ucyA9IGV2ZW50LmJ1dHRvbnNcbiAgICAgICAgQG1vdXNlTW92ZWQgID0gZmFsc2VcbiAgICAgICAgICAgIFxuICAgICAgICBAbW91c2VYID0gZXZlbnQuY2xpZW50WFxuICAgICAgICBAbW91c2VZID0gZXZlbnQuY2xpZW50WVxuICAgICAgICBcbiAgICAgICAgQGRvd25Qb3MgPSB2ZWMgQG1vdXNlWCwgQG1vdXNlWVxuICAgICAgICBcbiAgICBvbk1vdXNlVXA6IChldmVudCkgPT4gI2tsb2cgJ3VwJ1xuXG4gICAgb25Nb3VzZURyYWc6IChldmVudCkgPT5cblxuICAgICAgICB4ID0gZXZlbnQuY2xpZW50WC1AbW91c2VYXG4gICAgICAgIHkgPSBldmVudC5jbGllbnRZLUBtb3VzZVlcblxuICAgICAgICBAbW91c2VYID0gZXZlbnQuY2xpZW50WFxuICAgICAgICBAbW91c2VZID0gZXZlbnQuY2xpZW50WVxuICAgICAgICBcbiAgICAgICAgaWYgQGRvd25Qb3M/LmRpc3QodmVjIEBtb3VzZVgsIEBtb3VzZVkpID4gNjBcbiAgICAgICAgICAgIEBtb3VzZU1vdmVkID0gdHJ1ZVxuICAgICAgICBcbiAgICAgICAgaWYgZXZlbnQuYnV0dG9ucyAmIDRcbiAgICAgICAgICAgIHMgPSBAZGlzdFxuICAgICAgICAgICAgQHBhbiB4KjIqcy9Ac2l6ZS54LCB5KnMvQHNpemUueVxuICAgICAgICAgICAgXG4gICAgICAgIGlmIGV2ZW50LmJ1dHRvbnMgJiAzXG4gICAgICAgICAgICBAcGl2b3QgNDAwMCp4L0BzaXplLngsIDIwMDAqeS9Ac2l6ZS55ICAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwICAgMDAwIDAwMCAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAgMDAwICAgICAgMCAgICAgICAwMDAwMDAwICAgICAgMDAwICAgICBcbiAgICBcbiAgICBwaXZvdDogKHgseSkgLT5cbiAgICAgICAgIFxuICAgICAgICBAcm90YXRlICs9IDAuMSp4XG4gICAgICAgIEBkZWdyZWUgKz0gMC4xKnlcbiAgICAgICAgICAgICAgICAgXG4gICAgICAgIEBuYXZpZ2F0ZSgpXG4gICAgICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAgMCAwMDAgIFxuICAgICMgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgXG4gICAgIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICBcbiAgICBwYW46ICh4LHkpIC0+XG4gICAgICAgIFxuICAgICAgICByaWdodCA9IHZlYyAteCwgMCwgMCBcbiAgICAgICAgcmlnaHQuYXBwbHlRdWF0ZXJuaW9uIEByb3RhdGlvblF1YXRlcm5pb25cblxuICAgICAgICB1cCA9IHZlYyAwLCB5LCAwIFxuICAgICAgICB1cC5hcHBseVF1YXRlcm5pb24gQHJvdGF0aW9uUXVhdGVybmlvblxuICAgICAgICBcbiAgICAgICAgQGNlbnRlci5hZGQgcmlnaHQucGx1cyB1cFxuICAgICAgICBAY2VudGVyVGFyZ2V0Py5jb3B5IEBjZW50ZXJcbiAgICAgICAgQG5hdmlnYXRlKClcbiAgICAgICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuICAgICMgMDAwICAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuICAgICAgICAgICAgICAgICAgICAgXG4gICAgZmFkZVRvUG9zOiAodikgLT4gXG4gICAgICAgIFxuICAgICAgICBAY2VudGVyVGFyZ2V0ID0gdmVjIHZcbiAgICAgICAgQHN0YXJ0RmFkZUNlbnRlcigpXG5cbiAgICBzdGFydEZhZGVDZW50ZXI6IC0+IFxuICAgICAgICBcbiAgICAgICAgaWYgbm90IEBmYWRpbmdcbiAgICAgICAgICAgIGFuaW1hdGUgQGZhZGVDZW50ZXJcbiAgICAgICAgICAgIEBmYWRpbmcgPSB0cnVlXG4gICAgICAgICAgICBcbiAgICBmYWRlQ2VudGVyOiAoZGVsdGFTZWNvbmRzKSA9PlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIG5vdCBAZmFkaW5nXG4gICAgICAgIFxuICAgICAgICBAY2VudGVyLmZhZGUgQGNlbnRlclRhcmdldCwgZGVsdGFTZWNvbmRzXG4gICAgICAgIEBuYXZpZ2F0ZSgpXG4gICAgICAgIFxuICAgICAgICBpZiBAY2VudGVyLmRpc3QoQGNlbnRlclRhcmdldCkgPiAwLjAwMDAxXG4gICAgICAgICAgICBhbmltYXRlIEBmYWRlQ2VudGVyXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGRlbGV0ZSBAZmFkaW5nXG5cbiAgICAjIDAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwIDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgICAgMCAgICAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBtb3ZlRm9yd2FyZDogIC0+IEBzdGFydE1vdmUgQG1vdmVaID0gMVxuICAgIG1vdmVSaWdodDogICAgLT4gQHN0YXJ0TW92ZSBAbW92ZVggPSAxXG4gICAgbW92ZVVwOiAgICAgICAtPiBAc3RhcnRNb3ZlIEBtb3ZlWSA9IDFcbiAgICBtb3ZlTGVmdDogICAgIC0+IEBzdGFydE1vdmUgQG1vdmVYID0gLTFcbiAgICBtb3ZlRG93bjogICAgIC0+IEBzdGFydE1vdmUgQG1vdmVZID0gLTFcbiAgICBtb3ZlQmFja3dhcmQ6IC0+IEBzdGFydE1vdmUgQG1vdmVaID0gLTEgICAgICAgICAgXG5cbiAgICBzdG9wUmlnaHQ6ICAgIC0+IEBtb3ZlWCA9IGNsYW1wIC0xIDAgQG1vdmVYXG4gICAgc3RvcExlZnQ6ICAgICAtPiBAbW92ZVggPSBjbGFtcCAgMCAxIEBtb3ZlWFxuICAgIHN0b3BVcDogICAgICAgLT4gQG1vdmVZID0gY2xhbXAgLTEgMCBAbW92ZVlcbiAgICBzdG9wRG93bjogICAgIC0+IEBtb3ZlWSA9IGNsYW1wICAwIDEgQG1vdmVZXG4gICAgc3RvcEZvcndhcmQ6ICAtPiBAbW92ZVogPSBjbGFtcCAtMSAwIEBtb3ZlWlxuICAgIHN0b3BCYWNrd2FyZDogLT4gQG1vdmVaID0gY2xhbXAgIDAgMSBAbW92ZVpcbiAgICAgICAgXG4gICAgc3RvcE1vdmluZzogLT5cbiAgICAgICAgXG4gICAgICAgIEBtb3ZpbmcgPSBmYWxzZVxuICAgICAgICBAbW92ZVggPSAwXG4gICAgICAgIEBtb3ZlWSA9IDBcbiAgICAgICAgQG1vdmVaID0gMFxuICAgICAgIFxuICAgIHN0YXJ0TW92ZTogLT4gXG4gICAgICAgIFxuICAgICAgICBAZmFkaW5nID0gZmFsc2VcbiAgICAgICAgaWYgbm90IEBtb3ZpbmdcbiAgICAgICAgICAgIEBkaXN0ID0gQG1pbkRpc3RcbiAgICAgICAgICAgIEBjZW50ZXIgPSBAcG9zaXRpb24ucGx1cyBAZ2V0RGlyKCkubXVsIEBkaXN0XG4gICAgICAgICAgICBhbmltYXRlIEBtb3ZlQ2VudGVyXG4gICAgICAgICAgICBAbW92aW5nID0gdHJ1ZVxuICAgICAgICAgICAgXG4gICAgbW92ZUNlbnRlcjogKGRlbHRhU2Vjb25kcykgPT5cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBub3QgQG1vdmluZ1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBkaXIgPSB2ZWMoKVxuICAgICAgICBkaXIuYWRkIFZlY3QudW5pdFgubXVsIDEwICogKEBtb3ZlWCBvciBAbW92ZUZhZGUueClcbiAgICAgICAgZGlyLmFkZCBWZWN0LnVuaXRZLm11bCAxMCAqIChAbW92ZVkgb3IgQG1vdmVGYWRlLnkpXG4gICAgICAgIGRpci5hZGQgVmVjdC51bml0Wi5tdWwgMTAgKiAoQG1vdmVaIG9yIEBtb3ZlRmFkZS56KVxuICAgICAgICBcbiAgICAgICAgZGlyLnNjYWxlIGRlbHRhU2Vjb25kc1xuICAgICAgICBAcm90YXRpb25RdWF0ZXJuaW9uLnJvdGF0ZSBkaXJcbiAgICAgICAgXG4gICAgICAgIEBjZW50ZXIuYWRkIGRpclxuICAgICAgICBAbmF2aWdhdGUoKVxuICAgICAgICBcbiAgICAgICAgQG1vdmVGYWRlLnggPSBAbW92ZVggb3IgcmVkdWNlIEBtb3ZlRmFkZS54LCBkZWx0YVNlY29uZHNcbiAgICAgICAgQG1vdmVGYWRlLnkgPSBAbW92ZVkgb3IgcmVkdWNlIEBtb3ZlRmFkZS55LCBkZWx0YVNlY29uZHNcbiAgICAgICAgQG1vdmVGYWRlLnogPSBAbW92ZVogb3IgcmVkdWNlIEBtb3ZlRmFkZS56LCBkZWx0YVNlY29uZHNcbiAgICAgICAgXG4gICAgICAgIGlmIEBtb3ZlRmFkZS5sZW5ndGgoKSA+IDAuMDAxXG4gICAgICAgICAgICBhbmltYXRlIEBtb3ZlQ2VudGVyXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBzdG9wTW92aW5nKClcbiAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgIFxuICAgICMgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICBcbiAgICAjIDAwICAgICAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAgIFxuICAgIFxuICAgIG9uTW91c2VXaGVlbDogKGV2ZW50KSA9PiBcbiAgICAgICAgICAgIFxuICAgICAgICBpZiBAd2hlZWxJbmVydCA+IDAgYW5kIGV2ZW50LndoZWVsRGVsdGEgPCAwXG4gICAgICAgICAgICBAd2hlZWxJbmVydCA9IDBcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgXG4gICAgICAgIGlmIEB3aGVlbEluZXJ0IDwgMCBhbmQgZXZlbnQud2hlZWxEZWx0YSA+IDBcbiAgICAgICAgICAgIEB3aGVlbEluZXJ0ID0gMFxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICBcbiAgICAgICAgQHdoZWVsSW5lcnQgKz0gZXZlbnQud2hlZWxEZWx0YSAqICgxKyhAZGlzdC9AbWF4RGlzdCkqMykgKiAwLjAwMDFcbiAgICAgICAgXG4gICAgICAgIEBzdGFydFpvb20oKVxuXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAgICAgIDAwICBcbiAgICAjICAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgICAwMDAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgXG4gICAgIyAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuXG4gICAgc3RhcnRab29tSW46IC0+XG4gICAgICAgIFxuICAgICAgICBAd2hlZWxJbmVydCA9ICgxKyhAZGlzdC9AbWF4RGlzdCkqMykqMTBcbiAgICAgICAgQHN0YXJ0Wm9vbSgpXG4gICAgICAgIFxuICAgIHN0YXJ0Wm9vbU91dDogLT5cbiAgICAgICAgXG4gICAgICAgIEB3aGVlbEluZXJ0ID0gLSgxKyhAZGlzdC9AbWF4RGlzdCkqMykqMTBcbiAgICAgICAgQHN0YXJ0Wm9vbSgpXG4gICAgXG4gICAgc3RhcnRab29tOiAtPiBcbiAgICAgICAgXG4gICAgICAgIGlmIG5vdCBAem9vbWluZ1xuICAgICAgICAgICAgYW5pbWF0ZSBAaW5lcnRab29tXG4gICAgICAgICAgICBAem9vbWluZyA9IHRydWVcbiAgICAgICAgICAgIFxuICAgIHN0b3Bab29tOiAtPiBcbiAgICAgICAgXG4gICAgICAgIEB3aGVlbEluZXJ0ID0gMFxuICAgICAgICBAem9vbWluZyA9IGZhbHNlXG4gICAgXG4gICAgaW5lcnRab29tOiAoZGVsdGFTZWNvbmRzKSA9PlxuXG4gICAgICAgIEBzZXREaXN0IDEgLSBjbGFtcCAtMC4wMiAwLjAyIEB3aGVlbEluZXJ0XG4gICAgICAgIEB3aGVlbEluZXJ0ID0gcmVkdWNlIEB3aGVlbEluZXJ0LCBkZWx0YVNlY29uZHMqMC4yXG4gICAgICAgIGlmIE1hdGguYWJzKEB3aGVlbEluZXJ0KSA+IDAuMDAwMDAwMDFcbiAgICAgICAgICAgIGFuaW1hdGUgQGluZXJ0Wm9vbVxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBkZWxldGUgQHpvb21pbmdcbiAgICAgICAgICAgIEB3aGVlbEluZXJ0ID0gMFxuICAgIFxuICAgIHNldERpc3Q6IChmYWN0b3IpID0+XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIEBkaXN0ID0gY2xhbXAgQG1pbkRpc3QsIEBtYXhEaXN0LCBAZGlzdCpmYWN0b3JcbiAgICAgICAgQG5hdmlnYXRlKClcbiAgICAgICAgXG4gICAgc2V0Rm92OiAoZm92KSAtPiBAZm92ID0gTWF0aC5tYXgoMi4wIE1hdGgubWluIGZvdiwgMTc1LjApXG4gICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAgICAgICAgIDAwMDAwMDAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBuYXZpZ2F0ZTogLT4gXG4gICAgICAgIFxuICAgICAgICBAZGVncmVlID0gY2xhbXAgMSAxNzkgQGRlZ3JlZVxuICAgICAgICBcbiAgICAgICAgeWF3ICAgPSBkZWcycmFkIEByb3RhdGVcbiAgICAgICAgcGl0Y2ggPSBkZWcycmFkIEBkZWdyZWVcbiAgICAgICAgQHJvdGF0aW9uUXVhdGVybmlvbi5jb3B5RnJvbSBRdWF0LlJvdGF0aW9uWWF3UGl0Y2hSb2xsIHlhdywgcGl0Y2gsIDBcbiAgICAgICAgQHBvc2l0aW9uLmNvcHlGcm9tIEBjZW50ZXIucGx1cyBAcm90YXRpb25RdWF0ZXJuaW9uLnJvdGF0ZSB2ZWMoMCAwIC1AZGlzdClcbiAgICAgICAgQHNldFRhcmdldCBAY2VudGVyXG4gICAgICAgIFxuICAgICAgICBpZiAxOCpAbWluRGlzdC9AZGlzdCA+PSA4XG4gICAgICAgICAgICBAc2NlbmUuc3R5bGUuZm9udFNpemUgPSAxOCpAbWluRGlzdC9AZGlzdFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBAc2NlbmUuc3R5bGUuZm9udFNpemUgPSAwXG4gICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBDYW1lcmFcbiJdfQ==
//# sourceURL=../coffee/camera.coffee