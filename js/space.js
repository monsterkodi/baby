// koffee 1.7.0

/*
 0000000  00000000    0000000    0000000  00000000
000       000   000  000   000  000       000     
0000000   00000000   000000000  000       0000000 
     000  000        000   000  000       000     
0000000   000        000   000   0000000  00000000
 */
var Dimension, Space, TransformNode, generate, klog, random, ref, vec;

ref = require('babylonjs'), Space = ref.Space, TransformNode = ref.TransformNode;

klog = require('kxk').klog;

random = Math.random;

vec = require('./poly/math').vec;

generate = require('./poly/generate');

Dimension = require('./dimension');

Space = (function() {
    function Space(world) {
        var d, dim, j, k, len, ref1, sz;
        this.world = world;
        this.scene = this.world.scene;
        this.dimstack = [];
        for (d = j = 0; j <= 2; d = ++j) {
            this.dimstack.push(new TransformNode('trans', this.scene, true));
            sz = (d === 2) && 10000 || 0.01;
            this.dimstack.slice(-1)[0].scaling.copyFromFloats(sz, sz, sz);
            ref1 = this.newDims();
            for (k = 0, len = ref1.length; k < len; k++) {
                dim = ref1[k];
                dim.parent = this.dimstack.slice(-1)[0];
            }
        }
    }

    Space.prototype.newDims = function() {
        var dims, i, j;
        dims = [];
        for (i = j = 0; j <= 5; i = ++j) {
            dims.push(new Dimension(this.world, 1, i));
        }
        return dims;
    };

    Space.prototype.render = function() {
        var camDir, camDist, camDistSort, camFact, campos, dim, hig2ctr, higer, high, inViewSort, j, k, l, len, len1, len2, len3, low, lower, m, mid2ctr, midle, oldDistance, ref1, ref2, ref3, ref4, swapDist, sz, trans0, trans2;
        swapDist = 40000;
        campos = vec(this.world.camera.position);
        camDir = this.world.camera.getDir();
        oldDistance = this.distance;
        camFact = function(a) {
            var cam2a;
            cam2a = campos.to(a.getAbsolutePosition());
            return camDir.angle(cam2a) * cam2a.length();
        };
        camDist = function(a) {
            return campos.dist(a.getAbsolutePosition());
        };
        inViewSort = function(a, b) {
            return camFact(a) - camFact(b);
        };
        camDistSort = function(a, b) {
            return camDist(a) - camDist(b);
        };
        higer = this.dimstack[2].getChildren();
        higer.sort(camDistSort);
        this.dimstack[1].parent = higer[0];
        this.dimstack[1].markAsDirty();
        midle = this.dimstack[1].getChildren();
        midle.sort(camDistSort);
        this.dimstack[0].parent = midle[0];
        this.dimstack[0].markAsDirty();
        lower = this.dimstack[0].getChildren();
        lower.sort(camDistSort);
        this.distance = campos.to(lower[0].getAbsolutePosition()).length();
        this.highDist = campos.to(higer[0].getAbsolutePosition()).length();
        this.distFactor = this.distance / swapDist;
        this.scene.legend.show("" + (parseInt(this.distance)));
        if (this.distance >= swapDist) {
            if (oldDistance < swapDist) {
                hig2ctr = vec(higer[0].getAbsolutePosition()).to(this.world.camera.center);
                ref1 = this.dimstack[0];
                for (j = 0, len = ref1.length; j < len; j++) {
                    low = ref1[j];
                    low.del();
                }
                this.dimstack[0].dispose();
                sz = 0.01;
                this.dimstack[2].scaling.copyFromFloats(sz, sz, sz);
                trans2 = new TransformNode('trans', this.scene, true);
                sz = 10000;
                trans2.scaling.copyFromFloats(sz, sz, sz);
                ref2 = this.newDims();
                for (k = 0, len1 = ref2.length; k < len1; k++) {
                    dim = ref2[k];
                    dim.parent = trans2;
                }
                this.dimstack.shift();
                this.dimstack.push(trans2);
                this.dimstack[1].parent = trans2.getChildren()[0];
                this.world.camera.dist *= 0.01;
                this.world.camera.center = vec(higer[0].getAbsolutePosition().add(hig2ctr.mul(0.01)));
                this.world.camera.navigate();
                this.distance *= 0.01;
                return this.distFactor = this.distance / swapDist;
            }
        } else if (this.distance < swapDist / 100 && oldDistance > swapDist / 100) {
            mid2ctr = vec(midle[0].getAbsolutePosition()).to(this.world.camera.center);
            this.dimstack[1].parent = null;
            ref3 = this.dimstack[2];
            for (l = 0, len2 = ref3.length; l < len2; l++) {
                high = ref3[l];
                high.del();
            }
            this.dimstack[2].dispose();
            sz = 10000;
            this.dimstack[1].scaling.copyFromFloats(sz, sz, sz);
            trans0 = new TransformNode('trans', this.scene, true);
            sz = 0.01;
            trans0.scaling.copyFromFloats(sz, sz, sz);
            ref4 = this.newDims();
            for (m = 0, len3 = ref4.length; m < len3; m++) {
                dim = ref4[m];
                dim.parent = trans0;
            }
            this.dimstack.pop();
            this.dimstack.unshift(trans0);
            this.world.camera.dist *= 100;
            this.world.camera.center = vec(midle[0].getAbsolutePosition().add(mid2ctr.mul(100)));
            this.world.camera.navigate();
            this.distance *= 100;
            return this.distFactor = this.distance / swapDist;
        }
    };

    return Space;

})();

module.exports = Space;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BhY2UuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7QUFBQSxJQUFBOztBQVFBLE1BQTJCLE9BQUEsQ0FBUSxXQUFSLENBQTNCLEVBQUUsaUJBQUYsRUFBUzs7QUFDUCxPQUFTLE9BQUEsQ0FBUSxLQUFSOztBQUNULFNBQVc7O0FBQ1gsTUFBUSxPQUFBLENBQVEsYUFBUjs7QUFDVixRQUFBLEdBQVcsT0FBQSxDQUFRLGlCQUFSOztBQUNYLFNBQUEsR0FBWSxPQUFBLENBQVEsYUFBUjs7QUFFTjtJQUVDLGVBQUMsS0FBRDtBQUVDLFlBQUE7UUFGQSxJQUFDLENBQUEsUUFBRDtRQUVBLElBQUMsQ0FBQSxLQUFELEdBQVMsSUFBQyxDQUFBLEtBQUssQ0FBQztRQUNoQixJQUFDLENBQUEsUUFBRCxHQUFZO0FBRVosYUFBUywwQkFBVDtZQUNJLElBQUMsQ0FBQSxRQUFRLENBQUMsSUFBVixDQUFlLElBQUksYUFBSixDQUFrQixPQUFsQixFQUEwQixJQUFDLENBQUEsS0FBM0IsRUFBa0MsSUFBbEMsQ0FBZjtZQUNBLEVBQUEsR0FBTSxDQUFDLENBQUEsS0FBSyxDQUFOLENBQUEsSUFBYSxLQUFiLElBQXNCO1lBQzVCLElBQUMsQ0FBQSxRQUFTLFVBQUUsQ0FBQSxDQUFBLENBQUMsQ0FBQyxPQUFPLENBQUMsY0FBdEIsQ0FBcUMsRUFBckMsRUFBeUMsRUFBekMsRUFBNkMsRUFBN0M7QUFDQTtBQUFBLGlCQUFBLHNDQUFBOztnQkFDSSxHQUFHLENBQUMsTUFBSixHQUFhLElBQUMsQ0FBQSxRQUFTLFVBQUUsQ0FBQSxDQUFBO0FBRDdCO0FBSko7SUFMRDs7b0JBWUgsT0FBQSxHQUFTLFNBQUE7QUFFTCxZQUFBO1FBQUEsSUFBQSxHQUFPO0FBQ1AsYUFBUywwQkFBVDtZQUNJLElBQUksQ0FBQyxJQUFMLENBQVUsSUFBSSxTQUFKLENBQWMsSUFBQyxDQUFBLEtBQWYsRUFBc0IsQ0FBdEIsRUFB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UUFBZCxDQUFBO1lBRUEsSUFBQyxDQUFBLFFBQUQsSUFBYTttQkFDYixJQUFDLENBQUEsVUFBRCxHQUFjLElBQUMsQ0FBQSxRQUFELEdBQVksU0EvQjdCOztJQXZFRDs7Ozs7O0FBeUdaLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICBcbjAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAgXG4gICAgIDAwMCAgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgIFxuMDAwMDAwMCAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDBcbiMjI1xuXG57IFNwYWNlLCBUcmFuc2Zvcm1Ob2RlIH0gPSByZXF1aXJlICdiYWJ5bG9uanMnXG57IGtsb2cgfSA9IHJlcXVpcmUgJ2t4aydcbnsgcmFuZG9tIH0gPSBNYXRoXG57IHZlYyB9ID0gcmVxdWlyZSAnLi9wb2x5L21hdGgnXG5nZW5lcmF0ZSA9IHJlcXVpcmUgJy4vcG9seS9nZW5lcmF0ZSdcbkRpbWVuc2lvbiA9IHJlcXVpcmUgJy4vZGltZW5zaW9uJ1xuXG5jbGFzcyBTcGFjZVxuXG4gICAgQDogKEB3b3JsZCkgLT5cblxuICAgICAgICBAc2NlbmUgPSBAd29ybGQuc2NlbmVcbiAgICAgICAgQGRpbXN0YWNrID0gW11cbiAgICAgICAgXG4gICAgICAgIGZvciBkIGluIFswLi4yXVxuICAgICAgICAgICAgQGRpbXN0YWNrLnB1c2ggbmV3IFRyYW5zZm9ybU5vZGUgJ3RyYW5zJyBAc2NlbmUsIHRydWVcbiAgICAgICAgICAgIHN6ID0gKChkID09IDIpIGFuZCAxMDAwMCBvciAwLjAxKVxuICAgICAgICAgICAgQGRpbXN0YWNrWy0xXS5zY2FsaW5nLmNvcHlGcm9tRmxvYXRzIHN6LCBzeiwgc3pcbiAgICAgICAgICAgIGZvciBkaW0gaW4gQG5ld0RpbXMoKVxuICAgICAgICAgICAgICAgIGRpbS5wYXJlbnQgPSBAZGltc3RhY2tbLTFdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgbmV3RGltczogLT5cbiAgICAgICAgXG4gICAgICAgIGRpbXMgPSBbXVxuICAgICAgICBmb3IgaSBpbiBbMC4uNV1cbiAgICAgICAgICAgIGRpbXMucHVzaCBuZXcgRGltZW5zaW9uIEB3b3JsZCwgMSwgaVxuICAgICAgICBkaW1zICAgICAgICBcbiAgICAgICAgXG4gICAgcmVuZGVyOiAtPlxuICAgICAgICBcbiAgICAgICAgc3dhcERpc3QgPSA0MDAwMFxuICAgICAgICBjYW1wb3MgPSB2ZWMgQHdvcmxkLmNhbWVyYS5wb3NpdGlvblxuICAgICAgICBjYW1EaXIgPSBAd29ybGQuY2FtZXJhLmdldERpcigpXG4gICAgICAgIG9sZERpc3RhbmNlID0gQGRpc3RhbmNlXG4gICAgICAgICAgICAgICAgXG4gICAgICAgIGNhbUZhY3QgPSAoYSkgLT4gXG4gICAgICAgICAgICBjYW0yYSA9IGNhbXBvcy50byBhLmdldEFic29sdXRlUG9zaXRpb24oKVxuICAgICAgICAgICAgY2FtRGlyLmFuZ2xlKGNhbTJhKSAqIGNhbTJhLmxlbmd0aCgpXG4gICAgICAgICAgICBcbiAgICAgICAgY2FtRGlzdCA9IChhKSAtPiBjYW1wb3MuZGlzdCBhLmdldEFic29sdXRlUG9zaXRpb24oKVxuICAgICAgICAgICAgXG4gICAgICAgIGluVmlld1NvcnQgPSAoYSxiKSAtPiBjYW1GYWN0KGEpIC0gY2FtRmFjdChiKVxuICAgICAgICBjYW1EaXN0U29ydCA9IChhLGIpIC0+IGNhbURpc3QoYSkgLSBjYW1EaXN0KGIpXG5cbiAgICAgICAgaGlnZXIgPSBAZGltc3RhY2tbMl0uZ2V0Q2hpbGRyZW4oKVxuICAgICAgICBoaWdlci5zb3J0IGNhbURpc3RTb3J0IFxuICAgICAgICBAZGltc3RhY2tbMV0ucGFyZW50ID0gaGlnZXJbMF1cbiAgICAgICAgQGRpbXN0YWNrWzFdLm1hcmtBc0RpcnR5KClcbiAgICAgICAgXG4gICAgICAgIG1pZGxlID0gQGRpbXN0YWNrWzFdLmdldENoaWxkcmVuKClcbiAgICAgICAgbWlkbGUuc29ydCBjYW1EaXN0U29ydCBcbiAgICAgICAgQGRpbXN0YWNrWzBdLnBhcmVudCA9IG1pZGxlWzBdXG4gICAgICAgIEBkaW1zdGFja1swXS5tYXJrQXNEaXJ0eSgpXG4gICAgICAgIFxuICAgICAgICBsb3dlciA9IEBkaW1zdGFja1swXS5nZXRDaGlsZHJlbigpXG4gICAgICAgIGxvd2VyLnNvcnQgY2FtRGlzdFNvcnQgXG4gICAgICAgIFxuICAgICAgICBAZGlzdGFuY2UgPSBjYW1wb3MudG8obG93ZXJbMF0uZ2V0QWJzb2x1dGVQb3NpdGlvbigpKS5sZW5ndGgoKVxuICAgICAgICBAaGlnaERpc3QgPSBjYW1wb3MudG8oaGlnZXJbMF0uZ2V0QWJzb2x1dGVQb3NpdGlvbigpKS5sZW5ndGgoKVxuICAgICAgICBAZGlzdEZhY3RvciA9IEBkaXN0YW5jZSAvIHN3YXBEaXN0XG4gICAgICAgIFxuICAgICAgICAjIGtsb2cgJ2Rpc3RhbmNlJyBwYXJzZUludCBAZGlzdGFuY2UgIywgaGlnZXJbMF0ubmFtZSwgbWlkbGVbMF0ubmFtZSwgbG93ZXJbMF0ubmFtZVxuICAgICAgICBcbiAgICAgICAgQHNjZW5lLmxlZ2VuZC5zaG93IFwiI3twYXJzZUludCBAZGlzdGFuY2V9XCJcbiAgICAgICAgXG4gICAgICAgIGlmIEBkaXN0YW5jZSA+PSBzd2FwRGlzdFxuICAgICAgICAgICAgaWYgb2xkRGlzdGFuY2UgPCBzd2FwRGlzdFxuICAgICAgICAgICAgICAgICMga2xvZyAnZGlzdGFuY2UnIEBkaXN0YW5jZSwgJ2Rpc3RGYWN0b3InIEBkaXN0RmFjdG9yXG5cbiAgICAgICAgICAgICAgICBoaWcyY3RyID0gdmVjKGhpZ2VyWzBdLmdldEFic29sdXRlUG9zaXRpb24oKSkudG8gQHdvcmxkLmNhbWVyYS5jZW50ZXJcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgbG93IGluIEBkaW1zdGFja1swXVxuICAgICAgICAgICAgICAgICAgICBsb3cuZGVsKClcbiAgICAgICAgICAgICAgICBAZGltc3RhY2tbMF0uZGlzcG9zZSgpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc3ogPSAwLjAxXG4gICAgICAgICAgICAgICAgQGRpbXN0YWNrWzJdLnNjYWxpbmcuY29weUZyb21GbG9hdHMgc3osIHN6LCBzelxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRyYW5zMiA9IG5ldyBUcmFuc2Zvcm1Ob2RlICd0cmFucycgQHNjZW5lLCB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzeiA9IDEwMDAwXG4gICAgICAgICAgICAgICAgdHJhbnMyLnNjYWxpbmcuY29weUZyb21GbG9hdHMgc3osIHN6LCBzelxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvciBkaW0gaW4gQG5ld0RpbXMoKVxuICAgICAgICAgICAgICAgICAgICBkaW0ucGFyZW50ID0gdHJhbnMyXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgQGRpbXN0YWNrLnNoaWZ0KClcbiAgICAgICAgICAgICAgICBAZGltc3RhY2sucHVzaCB0cmFuczJcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBAZGltc3RhY2tbMV0ucGFyZW50ID0gdHJhbnMyLmdldENoaWxkcmVuKClbMF1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBAd29ybGQuY2FtZXJhLmRpc3QgKj0gMC4wMVxuICAgICAgICAgICAgICAgIEB3b3JsZC5jYW1lcmEuY2VudGVyID0gdmVjIGhpZ2VyWzBdLmdldEFic29sdXRlUG9zaXRpb24oKS5hZGQgaGlnMmN0ci5tdWwgMC4wMVxuICAgICAgICAgICAgICAgIEB3b3JsZC5jYW1lcmEubmF2aWdhdGUoKVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIEBkaXN0YW5jZSAqPSAwLjAxXG4gICAgICAgICAgICAgICAgQGRpc3RGYWN0b3IgPSBAZGlzdGFuY2UgLyBzd2FwRGlzdFxuICAgICAgICAgICAgICAgICMga2xvZyAnbmV3RGlzdGFuY2UnIEBkaXN0YW5jZSwgQHdvcmxkLmNhbWVyYS5wb3NpdGlvbi5sZW5ndGgoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgZWxzZSBpZiBAZGlzdGFuY2UgPCBzd2FwRGlzdC8xMDAgYW5kIG9sZERpc3RhbmNlID4gc3dhcERpc3QvMTAwXG5cbiAgICAgICAgICAgICAgICAjIGtsb2cgJ2Rpc3RhbmNlJyBAZGlzdGFuY2UsICdkaXN0RmFjdG9yJyBAZGlzdEZhY3RvclxuXG4gICAgICAgICAgICAgICAgbWlkMmN0ciA9IHZlYyhtaWRsZVswXS5nZXRBYnNvbHV0ZVBvc2l0aW9uKCkpLnRvIEB3b3JsZC5jYW1lcmEuY2VudGVyXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgQGRpbXN0YWNrWzFdLnBhcmVudCA9IG51bGxcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgaGlnaCBpbiBAZGltc3RhY2tbMl1cbiAgICAgICAgICAgICAgICAgICAgaGlnaC5kZWwoKVxuICAgICAgICAgICAgICAgIEBkaW1zdGFja1syXS5kaXNwb3NlKClcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzeiA9IDEwMDAwXG4gICAgICAgICAgICAgICAgQGRpbXN0YWNrWzFdLnNjYWxpbmcuY29weUZyb21GbG9hdHMgc3osIHN6LCBzelxuXG4gICAgICAgICAgICAgICAgdHJhbnMwID0gbmV3IFRyYW5zZm9ybU5vZGUgJ3RyYW5zJyBAc2NlbmUsIHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc3ogPSAwLjAxXG4gICAgICAgICAgICAgICAgdHJhbnMwLnNjYWxpbmcuY29weUZyb21GbG9hdHMgc3osIHN6LCBzelxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGZvciBkaW0gaW4gQG5ld0RpbXMoKVxuICAgICAgICAgICAgICAgICAgICBkaW0ucGFyZW50ID0gdHJhbnMwXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgQGRpbXN0YWNrLnBvcCgpXG4gICAgICAgICAgICAgICAgQGRpbXN0YWNrLnVuc2hpZnQgdHJhbnMwXG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgQHdvcmxkLmNhbWVyYS5kaXN0ICo9IDEwMFxuICAgICAgICAgICAgICAgIEB3b3JsZC5jYW1lcmEuY2VudGVyID0gdmVjIG1pZGxlWzBdLmdldEFic29sdXRlUG9zaXRpb24oKS5hZGQgbWlkMmN0ci5tdWwgMTAwXG4gICAgICAgICAgICAgICAgQHdvcmxkLmNhbWVyYS5uYXZpZ2F0ZSgpXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgQGRpc3RhbmNlICo9IDEwMFxuICAgICAgICAgICAgICAgIEBkaXN0RmFjdG9yID0gQGRpc3RhbmNlIC8gc3dhcERpc3RcbiAgICAgICAgICAgICAgICAjIGtsb2cgJ25ld0Rpc3RhbmNlJyBAZGlzdGFuY2UsIEB3b3JsZC5jYW1lcmEucG9zaXRpb24ubGVuZ3RoKClcbiAgICAgICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBTcGFjZVxuIl19
//# sourceURL=../coffee/space.coffee