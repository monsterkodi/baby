// koffee 1.6.0

/*
 0000000  000   000   0000000   0000000    00000000  00000000   
000       000   000  000   000  000   000  000       000   000  
0000000   000000000  000000000  000   000  0000000   0000000    
     000  000   000  000   000  000   000  000       000   000  
0000000   000   000  000   000  0000000    00000000  000   000
 */
var Effect, Engine, Mesh, MeshBuilder, RawTexture, RenderTargetTexture, Shader, ShaderMaterial, Texture, Vector2, Vector3, Vector4, klog, performance, ref, ref1, slash,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('babylonjs'), Effect = ref.Effect, Engine = ref.Engine, Mesh = ref.Mesh, MeshBuilder = ref.MeshBuilder, RawTexture = ref.RawTexture, RenderTargetTexture = ref.RenderTargetTexture, ShaderMaterial = ref.ShaderMaterial, Texture = ref.Texture, Vector2 = ref.Vector2, Vector3 = ref.Vector3, Vector4 = ref.Vector4;

performance = require('perf_hooks').performance;

ref1 = require('kxk'), klog = ref1.klog, slash = ref1.slash;

Shader = (function() {
    function Shader(world) {
        var arr, bufferSource, fragSource;
        this.world = world;
        this.materialData = bind(this.materialData, this);
        this.scene = this.world.scene;
        this.bufferSize = {
            width: 512,
            height: 16
        };
        this.frameRates = [];
        this.buffer = false;
        this.textures = {
            keys: RawTexture.CreateRTexture(this.world.keys, 256, 3, this.scene, false),
            font: new Texture(__dirname + "/../img/font.png", this.scene)
        };
        if (this.buffer) {
            arr = new Float32Array(4 * this.bufferSize.width * this.bufferSize.height);
            this.textures.buffer = new RawTexture(arr, this.bufferSize.width, this.bufferSize.height, Engine.TEXTUREFORMAT_RGBA, this.scene, false, false, Texture.BILINEAR_SAMPLINGMODE, Engine.TEXTURETYPE_FLOAT);
        }
        this.iFrame = 0;
        this.vertexShader = "precision highp float; attribute vec3 position; attribute vec2 uv; uniform mat4 worldViewProjection;\nvoid main(void) { gl_Position = worldViewProjection * vec4(position, 1.0); }";
        fragSource = slash.readText(__dirname + "/../shader/hexwar.frag");
        if (this.buffer) {
            bufferSource = slash.readText(__dirname + "/../shader/eye_buffer.frag");
        }
        this.commonSource = slash.readText(__dirname + "/../shader/common.frag");
        Effect.ShadersStore.mainVertexShader = this.vertexShader;
        Effect.ShadersStore.mainFragmentShader = this.shaderCode(fragSource);
        if (this.buffer) {
            Effect.ShadersStore.bufferVertexShader = this.vertexShader;
            Effect.ShadersStore.bufferFragmentShader = this.shaderCode(bufferSource);
        }
        this.shaderStart = performance.now();
        this.shaderMaterial = this.shaderMaterial('main');
        this.shaderMaterial.onCompiled = (function(_this) {
            return function() {
                _this.compileTime = parseInt(performance.now() - _this.shaderStart);
                return klog("shader compileTime " + (_this.compileTime / 1000) + "s");
            };
        })(this);
        if (this.buffer) {
            this.bufferMaterial = this.shaderMaterial('buffer');
            this.bufferMaterial.onCompiled = (function(_this) {
                return function() {
                    var compileTime;
                    compileTime = parseInt(performance.now() - _this.shaderStart);
                    return klog("buffer compileTime " + (compileTime / 1000) + "s");
                };
            })(this);
            this.plane2 = MeshBuilder.CreatePlane("plane2", {
                width: 10,
                height: 10
            }, this.scene);
            this.plane2.material = this.bufferMaterial;
            this.plane2.billboardMode = Mesh.BILLBOARDMODE_ALL;
        }
        this.plane = MeshBuilder.CreatePlane("plane", {
            width: 10,
            height: 10
        }, this.scene);
        this.plane.material = this.shaderMaterial;
        this.plane.billboardMode = Mesh.BILLBOARDMODE_ALL;
        if (this.buffer) {
            this.renderTarget = new RenderTargetTexture("buf", this.bufferSize, this.scene, false, false, Texture.BILINEAR_SAMPLINGMODE, Engine.TEXTURETYPE_FLOAT);
            this.renderTarget.renderList.push(this.plane2);
            this.scene.customRenderTargets.push(this.renderTarget);
            this.renderTarget.onBeforeRender = (function(_this) {
                return function() {
                    _this.plane2.position.copyFrom(_this.world.camera.position.add(_this.world.camera.getDir().scale(2)));
                    return _this.materialData(_this.bufferMaterial);
                };
            })(this);
        }
        this.scene.onBeforeRenderObservable.add((function(_this) {
            return function() {
                var j, len, r, ref10, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9;
                _this.textures.keys.update(_this.world.keys);
                _this.iResolution = new Vector3(_this.world.canvas.width, _this.world.canvas.height, 1);
                _this.iDelta = new Vector2(_this.world.camera.mouse.delta.x, _this.world.camera.mouse.delta.y);
                if (_this.world.camera.mouse.buttons) {
                    _this.iMouse = new Vector4(_this.world.camera.mouse.pos.x * ((ref2 = window.devicePixelRatio) != null ? ref2 : 0), _this.iResolution.y - (_this.world.camera.mouse.pos.y * ((ref3 = window.devicePixelRatio) != null ? ref3 : _this.iResolution.y)), (_this.world.camera.mouse.buttons && 1 || -1) * _this.world.camera.mouse.down.x * ((ref4 = window.devicePixelRatio) != null ? ref4 : 0), (_this.world.camera.mouse.buttons && 1 || -1) * (_this.iResolution.y - (_this.world.camera.mouse.down.y * ((ref5 = window.devicePixelRatio) != null ? ref5 : _this.iResolution.y))));
                } else {
                    _this.iMouse = new Vector4(_this.world.camera.mouse.up.x * ((ref6 = window.devicePixelRatio) != null ? ref6 : 0), _this.iResolution.y - (_this.world.camera.mouse.up.y * ((ref7 = window.devicePixelRatio) != null ? ref7 : _this.iResolution.y)), (_this.world.camera.mouse.buttons && 1 || -1) * _this.world.camera.mouse.down.x * ((ref8 = window.devicePixelRatio) != null ? ref8 : 0), (_this.world.camera.mouse.buttons && 1 || -1) * (_this.iResolution.y - (_this.world.camera.mouse.down.y * ((ref9 = window.devicePixelRatio) != null ? ref9 : _this.iResolution.y))));
                }
                _this.iCenter = new Vector3(-_this.world.camera.center.x, _this.world.camera.center.y, _this.world.camera.center.z);
                _this.iCamera = new Vector3(-_this.world.camera.position.x, _this.world.camera.position.y, _this.world.camera.position.z);
                _this.iTime = performance.now() / 1000;
                _this.iTimeDelta = _this.world.engine.getDeltaTime() / 1000;
                _this.frameRates.push(_this.world.engine.getFps());
                if (_this.frameRates.length > 30) {
                    _this.frameRates.shift();
                }
                _this.fps = 0;
                ref10 = _this.frameRates;
                for (j = 0, len = ref10.length; j < len; j++) {
                    r = ref10[j];
                    _this.fps += r;
                }
                return _this.fps /= _this.frameRates.length;
            };
        })(this));
        this.scene.onAfterRenderTargetsRenderObservable.add((function(_this) {
            return function() {
                if (_this.buffer) {
                    return _this.textures.buffer.update(_this.renderTarget.readPixels());
                }
            };
        })(this));
        this.scene.onAfterRenderObservable.add((function(_this) {
            return function() {
                var i, j, results;
                _this.iFrame++;
                results = [];
                for (i = j = 256; j < 512; i = ++j) {
                    results.push(_this.world.keys[i] = 0);
                }
                return results;
            };
        })(this));
    }

    Shader.prototype.render = function() {
        this.plane.position.copyFrom(this.world.camera.position.add(this.world.camera.getDir().scale(1.5)));
        return this.materialData(this.shaderMaterial);
    };

    Shader.prototype.materialData = function(m) {
        m.setTexture('iChannel0', this.textures.keys);
        if (this.buffer) {
            m.setTexture('iChannel1', this.textures.buffer);
        }
        m.setTexture('iChannel2', this.textures.font);
        m.setInt('iFrame', this.iFrame);
        m.setFloat('iCompile', this.compileTime / 1000);
        m.setFloat('iTime', this.iTime);
        m.setFloat('iTimeDelta', this.iTimeDelta);
        m.setVector2('iDelta', this.iDelta);
        m.setVector4('iMouse', this.iMouse);
        m.setVector3('iResolution', this.iResolution);
        m.setVector3('iCenter', this.iCenter);
        m.setVector3('iCamera', this.iCamera);
        m.setFloat('iDist', this.world.camera.dist);
        m.setFloat('iMinDist', this.world.camera.minDist);
        m.setFloat('iMaxDist', this.world.camera.maxDist);
        m.setFloat('iRotate', this.world.camera.rotate);
        m.setFloat('iDegree', this.world.camera.degree);
        m.setFloat('iFrameRate', Math.round(this.fps));
        return m.setFloat('iMs', this.world.engine.getDeltaTime());
    };

    Shader.prototype.shaderMaterial = function(key) {
        return new ShaderMaterial(key + "Shader", this.scene, {
            vertex: key,
            fragment: key
        }, {
            attributes: ['position', 'normal', 'uv'],
            uniforms: ['worldViewProjection', 'iCamera', 'iCenter', 'iDist', 'iMaxDist', 'iMinDist', 'iFrameRate', 'iMs', 'iFrame', 'iDelta', 'iTime', 'iTimeDelta', 'iMouse', 'iResolution', 'iRotate', 'iDegree', 'iCompile']
        });
    };

    Shader.prototype.shaderCode = function(fragSource) {
        return "precision highp float;\nuniform float     iTime;\nuniform float     iTimeDelta;\nuniform float     iFrameRate;\nuniform float     iMs;\nuniform float     iCompile;\nuniform float     iDist;\nuniform float     iMinDist;\nuniform float     iMaxDist;\nuniform float     iRotate;\nuniform float     iDegree;\nuniform vec2      iDelta;\nuniform vec4      iMouse;\nuniform vec3      iResolution;\nuniform vec3      iCenter;\nuniform vec3      iCamera;\nuniform int       iFrame;\nuniform sampler2D iChannel0;\nuniform sampler2D iChannel1;\nuniform sampler2D iChannel2;\n\n" + this.commonSource + "\n" + fragSource + "\n                        \nvoid main(void) \n{\n    mainImage(gl_FragColor, gl_FragCoord.xy);\n}";
    };

    return Shader;

})();

module.exports = Shader;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhZGVyLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxtS0FBQTtJQUFBOztBQVFBLE1BQTZILE9BQUEsQ0FBUSxXQUFSLENBQTdILEVBQUUsbUJBQUYsRUFBVSxtQkFBVixFQUFrQixlQUFsQixFQUF3Qiw2QkFBeEIsRUFBcUMsMkJBQXJDLEVBQWlELDZDQUFqRCxFQUFzRSxtQ0FBdEUsRUFBc0YscUJBQXRGLEVBQStGLHFCQUEvRixFQUF3RyxxQkFBeEcsRUFBaUg7O0FBQy9HLGNBQWdCLE9BQUEsQ0FBUSxZQUFSOztBQUNsQixPQUFrQixPQUFBLENBQVEsS0FBUixDQUFsQixFQUFFLGdCQUFGLEVBQVE7O0FBRUY7SUFFQyxnQkFBQyxLQUFEO0FBRUMsWUFBQTtRQUZBLElBQUMsQ0FBQSxRQUFEOztRQUVBLElBQUMsQ0FBQSxLQUFELEdBQVMsSUFBQyxDQUFBLEtBQUssQ0FBQztRQUNoQixJQUFDLENBQUEsVUFBRCxHQUFjO1lBQUEsS0FBQSxFQUFNLEdBQU47WUFBVyxNQUFBLEVBQU8sRUFBbEI7O1FBQ2QsSUFBQyxDQUFBLFVBQUQsR0FBYztRQUVkLElBQUMsQ0FBQSxNQUFELEdBQVU7UUFFVixJQUFDLENBQUEsUUFBRCxHQUNJO1lBQUEsSUFBQSxFQUFRLFVBQVUsQ0FBQyxjQUFYLENBQTBCLElBQUMsQ0FBQSxLQUFLLENBQUMsSUFBakMsRUFBdUMsR0FBdkMsRUFBNEMsQ0FBNUMsRUFBK0MsSUFBQyxDQUFBLEtBQWhELEVBQXVELEtBQXZELENBQVI7WUFDQSxJQUFBLEVBQVEsSUFBSSxPQUFKLENBQWUsU0FBRCxHQUFXLGtCQUF6QixFQUE0QyxJQUFDLENBQUEsS0FBN0MsQ0FEUjs7UUFHSixJQUFHLElBQUMsQ0FBQSxNQUFKO1lBQ0ksR0FBQSxHQUFNLElBQUksWUFBSixDQUFpQixDQUFBLEdBQUUsSUFBQyxDQUFBLFVBQVUsQ0FBQyxLQUFkLEdBQW9C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LENBQUMsQ0FBQyxNQUFGLENBQWEsUUFBYixFQUEyQixJQUFDLENBQUEsTUFBNUI7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFVBQWIsRUFBMkIsSUFBQyxDQUFBLFdBQUQsR0FBYSxJQUF4QztRQUNBLENBQUMsQ0FBQyxRQUFGLENBQWEsT0FBYixFQUEyQixJQUFDLENBQUEsS0FBNUI7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFlBQWIsRUFBMkIsSUFBQyxDQUFBLFVBQTVCO1FBQ0EsQ0FBQyxDQUFDLFVBQUYsQ0FBYSxRQUFiLEVBQTJCLElBQUMsQ0FBQSxNQUE1QjtRQUNBLENBQUMsQ0FBQyxVQUFGLENBQWEsUUFBYixFQUEyQixJQUFDLENBQUEsTUFBNUI7UUFDQSxDQUFDLENBQUMsVUFBRixDQUFhLGFBQWIsRUFBMkIsSUFBQyxDQUFBLFdBQTVCO1FBQ0EsQ0FBQyxDQUFDLFVBQUYsQ0FBYSxTQUFiLEVBQTJCLElBQUMsQ0FBQSxPQUE1QjtRQUNBLENBQUMsQ0FBQyxVQUFGLENBQWEsU0FBYixFQUEyQixJQUFDLENBQUEsT0FBNUI7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLE9BQWIsRUFBMkIsSUFBQyxDQUFBLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBekM7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFVBQWIsRUFBMkIsSUFBQyxDQUFBLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBekM7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFVBQWIsRUFBMkIsSUFBQyxDQUFBLEtBQUssQ0FBQyxNQUFNLENBQUMsT0FBekM7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFNBQWIsRUFBMkIsSUFBQyxDQUFBLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBekM7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFNBQWIsRUFBMkIsSUFBQyxDQUFBLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBekM7UUFDQSxDQUFDLENBQUMsUUFBRixDQUFhLFlBQWIsRUFBMkIsSUFBSSxDQUFDLEtBQUwsQ0FBVyxJQUFDLENBQUEsR0FBWixDQUEzQjtlQUNBLENBQUMsQ0FBQyxRQUFGLENBQWEsS0FBYixFQUEyQixJQUFDLENBQUEsS0FBSyxDQUFDLE1BQU0sQ0FBQyxZQUFkLENBQUEsQ0FBM0I7SUFwQlU7O3FCQTRCZCxjQUFBLEdBQWdCLFNBQUMsR0FBRDtlQUVaLElBQUksY0FBSixDQUFzQixHQUFELEdBQUssUUFBMUIsRUFBbUMsSUFBQyxDQUFBLEtBQXBDLEVBQ1E7WUFBQSxNQUFBLEVBQVUsR0FBVjtZQUNBLFFBQUEsRUFBVSxHQURWO1NBRFIsRUFJUTtZQUFBLFVBQUEsRUFBWSxDQUFDLFVBQUQsRUFBWSxRQUFaLEVBQXFCLElBQXJCLENBQVo7WUFDQSxRQUFBLEVBQVksQ0FDUixxQkFEUSxFQUVSLFNBRlEsRUFFRSxTQUZGLEVBRVksT0FGWixFQUVvQixVQUZwQixFQUUrQixVQUYvQixFQUdSLFlBSFEsRUFHSyxLQUhMLEVBR1csUUFIWCxFQUlSLFFBSlEsRUFJQyxPQUpELEVBSVMsWUFKVCxFQUtSLFFBTFEsRUFLQyxhQUxELEVBTVIsU0FOUSxFQU1FLFNBTkYsRUFPUixVQVBRLENBRFo7U0FKUjtJQUZZOztxQkFpQmhCLFVBQUEsR0FBWSxTQUFDLFVBQUQ7ZUFDUix3akJBQUEsR0FzQk0sSUFBQyxDQUFBLFlBdEJQLEdBc0JvQixJQXRCcEIsR0F1Qk0sVUF2Qk4sR0F1QmlCO0lBeEJUOzs7Ozs7QUFnQ2hCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDAwICAgXG4wMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4wMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgXG4gICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4wMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4jIyNcblxueyBFZmZlY3QsIEVuZ2luZSwgTWVzaCwgTWVzaEJ1aWxkZXIsIFJhd1RleHR1cmUsIFJlbmRlclRhcmdldFRleHR1cmUsIFNoYWRlck1hdGVyaWFsLCBUZXh0dXJlLCBWZWN0b3IyLCBWZWN0b3IzLCBWZWN0b3I0IH0gPSByZXF1aXJlICdiYWJ5bG9uanMnXG57IHBlcmZvcm1hbmNlIH0gPSByZXF1aXJlICdwZXJmX2hvb2tzJ1xueyBrbG9nLCBzbGFzaCB9ID0gcmVxdWlyZSAna3hrJ1xuICAgICAgICBcbmNsYXNzIFNoYWRlclxuICAgIFxuICAgIEA6IChAd29ybGQpIC0+XG5cbiAgICAgICAgQHNjZW5lID0gQHdvcmxkLnNjZW5lXG4gICAgICAgIEBidWZmZXJTaXplID0gd2lkdGg6NTEyLCBoZWlnaHQ6MTZcbiAgICAgICAgQGZyYW1lUmF0ZXMgPSBbXVxuXG4gICAgICAgIEBidWZmZXIgPSBmYWxzZVxuICAgICAgICAgICAgXG4gICAgICAgIEB0ZXh0dXJlcyA9IFxuICAgICAgICAgICAga2V5czogICBSYXdUZXh0dXJlLkNyZWF0ZVJUZXh0dXJlIEB3b3JsZC5rZXlzLCAyNTYsIDMsIEBzY2VuZSwgZmFsc2VcbiAgICAgICAgICAgIGZvbnQ6ICAgbmV3IFRleHR1cmUoXCIje19fZGlybmFtZX0vLi4vaW1nL2ZvbnQucG5nXCIsIEBzY2VuZSlcbiAgICAgICAgXG4gICAgICAgIGlmIEBidWZmZXJcbiAgICAgICAgICAgIGFyciA9IG5ldyBGbG9hdDMyQXJyYXkgNCpAYnVmZmVyU2l6ZS53aWR0aCpAYnVmZmVyU2l6ZS5oZWlnaHRcbiAgICAgICAgICAgIEB0ZXh0dXJlcy5idWZmZXIgPSBuZXcgUmF3VGV4dHVyZSBhcnIsIEBidWZmZXJTaXplLndpZHRoLCBAYnVmZmVyU2l6ZS5oZWlnaHQsIEVuZ2luZS5URVhUVVJFRk9STUFUX1JHQkEsIEBzY2VuZSwgZmFsc2UsIGZhbHNlLCBUZXh0dXJlLkJJTElORUFSX1NBTVBMSU5HTU9ERSwgRW5naW5lLlRFWFRVUkVUWVBFX0ZMT0FUXG4gICAgICAgICAgICBcbiAgICAgICAgQGlGcmFtZSA9IDBcbiAgICAgICAgQHZlcnRleFNoYWRlciA9ICBcIlwiXCJcbiAgICAgICAgICAgIHByZWNpc2lvbiBoaWdocCBmbG9hdDsgYXR0cmlidXRlIHZlYzMgcG9zaXRpb247IGF0dHJpYnV0ZSB2ZWMyIHV2OyB1bmlmb3JtIG1hdDQgd29ybGRWaWV3UHJvamVjdGlvbjtcbiAgICAgICAgICAgIHZvaWQgbWFpbih2b2lkKSB7IGdsX1Bvc2l0aW9uID0gd29ybGRWaWV3UHJvamVjdGlvbiAqIHZlYzQocG9zaXRpb24sIDEuMCk7IH1cbiAgICAgICAgICAgIFwiXCJcIlxuICAgICAgICBcclxuICAgICAgICBmcmFnU291cmNlID0gc2xhc2gucmVhZFRleHQgXCIje19fZGlybmFtZX0vLi4vc2hhZGVyL2hleHdhci5mcmFnXCJcbiAgICAgICAgIyBmcmFnU291cmNlICAgID0gc2xhc2gucmVhZFRleHQgXCIje19fZGlybmFtZX0vLi4vc2hhZGVyL2tyYXAuZnJhZ1wiXG4gICAgICAgIGlmIEBidWZmZXIgdGhlbiBidWZmZXJTb3VyY2UgPSBzbGFzaC5yZWFkVGV4dCBcIiN7X19kaXJuYW1lfS8uLi9zaGFkZXIvZXllX2J1ZmZlci5mcmFnXCJcbiAgICAgICAgQGNvbW1vblNvdXJjZSA9IHNsYXNoLnJlYWRUZXh0IFwiI3tfX2Rpcm5hbWV9Ly4uL3NoYWRlci9jb21tb24uZnJhZ1wiXG4gICAgICAgICMgQGNvbW1vblNvdXJjZSA9IFwiXCJcbiAgICAgICAgXG4gICAgICAgIEVmZmVjdC5TaGFkZXJzU3RvcmUubWFpblZlcnRleFNoYWRlciAgID0gQHZlcnRleFNoYWRlclxuICAgICAgICBFZmZlY3QuU2hhZGVyc1N0b3JlLm1haW5GcmFnbWVudFNoYWRlciA9IEBzaGFkZXJDb2RlIGZyYWdTb3VyY2UgXG4gICAgICAgIFxuICAgICAgICBpZiBAYnVmZmVyIFxuICAgICAgICAgICAgRWZmZWN0LlNoYWRlcnNTdG9yZS5idWZmZXJWZXJ0ZXhTaGFkZXIgPSBAdmVydGV4U2hhZGVyXG4gICAgICAgICAgICBFZmZlY3QuU2hhZGVyc1N0b3JlLmJ1ZmZlckZyYWdtZW50U2hhZGVyID0gQHNoYWRlckNvZGUgYnVmZmVyU291cmNlIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgQHNoYWRlclN0YXJ0ID0gcGVyZm9ybWFuY2Uubm93KClcbiAgICAgICAgXG4gICAgICAgICMgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgIFxuICAgICAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICBcbiAgICAgICAgIyAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgXG4gICAgICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIFxuICAgICAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICBcbiAgICAgICAgXG4gICAgICAgIEBzaGFkZXJNYXRlcmlhbCA9IEBzaGFkZXJNYXRlcmlhbCAnbWFpbidcbiAgICAgICAgQHNoYWRlck1hdGVyaWFsLm9uQ29tcGlsZWQgPSA9PiBcbiAgICAgICAgICAgIEBjb21waWxlVGltZSA9IHBhcnNlSW50IHBlcmZvcm1hbmNlLm5vdygpLUBzaGFkZXJTdGFydFxuICAgICAgICAgICAga2xvZyBcInNoYWRlciBjb21waWxlVGltZSAje0Bjb21waWxlVGltZS8xMDAwfXNcIiBcblxuICAgICAgICBpZiBAYnVmZmVyXG4gICAgICAgICAgICBAYnVmZmVyTWF0ZXJpYWwgPSBAc2hhZGVyTWF0ZXJpYWwgJ2J1ZmZlcidcbiAgICAgICAgICAgIEBidWZmZXJNYXRlcmlhbC5vbkNvbXBpbGVkID0gPT4gXG4gICAgICAgICAgICAgICAgY29tcGlsZVRpbWUgPSBwYXJzZUludCBwZXJmb3JtYW5jZS5ub3coKS1Ac2hhZGVyU3RhcnRcbiAgICAgICAgICAgICAgICBrbG9nIFwiYnVmZmVyIGNvbXBpbGVUaW1lICN7Y29tcGlsZVRpbWUvMTAwMH1zXCIgXG5cbiAgICAgICAgICAgIEBwbGFuZTIgPSBNZXNoQnVpbGRlci5DcmVhdGVQbGFuZSBcInBsYW5lMlwiLCB7IHdpZHRoOiAxMCwgaGVpZ2h0OiAxMCB9LCBAc2NlbmVcbiAgICAgICAgICAgIEBwbGFuZTIubWF0ZXJpYWwgPSBAYnVmZmVyTWF0ZXJpYWxcbiAgICAgICAgICAgIEBwbGFuZTIuYmlsbGJvYXJkTW9kZSA9IE1lc2guQklMTEJPQVJETU9ERV9BTExcblxuICAgICAgICBAcGxhbmUgPSBNZXNoQnVpbGRlci5DcmVhdGVQbGFuZSBcInBsYW5lXCIgeyB3aWR0aDogMTAsIGhlaWdodDogMTAgfSBAc2NlbmVcbiAgICAgICAgQHBsYW5lLm1hdGVyaWFsID0gQHNoYWRlck1hdGVyaWFsXG4gICAgICAgIEBwbGFuZS5iaWxsYm9hcmRNb2RlID0gTWVzaC5CSUxMQk9BUkRNT0RFX0FMTFxuICAgICAgICBcbiAgICAgICAgIyAwMDAwMDAwMCAgICAgICAgICAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAwICBcbiAgICAgICAgIyAwMDAgICAwMDAgICAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgICAgMDAwICAgICBcbiAgICAgICAgIyAwMDAwMDAwICAgIDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwICAwMDAwICAwMDAwMDAwICAgICAgMDAwICAgICBcbiAgICAgICAgIyAwMDAgICAwMDAgICAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICBcbiAgICAgICAgIyAwMDAgICAwMDAgICAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgICAgMDAwICAgICBcbiAgICAgICAgXG4gICAgICAgIGlmIEBidWZmZXJcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQHJlbmRlclRhcmdldCA9IG5ldyBSZW5kZXJUYXJnZXRUZXh0dXJlIFwiYnVmXCIsIEBidWZmZXJTaXplLCBAc2NlbmUsIGZhbHNlLCBmYWxzZSwgVGV4dHVyZS5CSUxJTkVBUl9TQU1QTElOR01PREUsIEVuZ2luZS5URVhUVVJFVFlQRV9GTE9BVFxuICAgICAgICAgICAgQHJlbmRlclRhcmdldC5yZW5kZXJMaXN0LnB1c2ggQHBsYW5lMlxuICAgICAgICAgICAgQHNjZW5lLmN1c3RvbVJlbmRlclRhcmdldHMucHVzaCBAcmVuZGVyVGFyZ2V0XG4gICAgXHIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgQHJlbmRlclRhcmdldC5vbkJlZm9yZVJlbmRlciA9ICgpID0+IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIEBwbGFuZTIucG9zaXRpb24uY29weUZyb20gQHdvcmxkLmNhbWVyYS5wb3NpdGlvbi5hZGQgQHdvcmxkLmNhbWVyYS5nZXREaXIoKS5zY2FsZSAyXG4gICAgICAgICAgICAgICAgQG1hdGVyaWFsRGF0YSBAYnVmZmVyTWF0ZXJpYWxcbiAgICAgICAgXG4gICAgICAgIEBzY2VuZS5vbkJlZm9yZVJlbmRlck9ic2VydmFibGUuYWRkID0+IFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAdGV4dHVyZXMua2V5cy51cGRhdGUgQHdvcmxkLmtleXNcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQGlSZXNvbHV0aW9uID0gbmV3IFZlY3RvcjMgQHdvcmxkLmNhbnZhcy53aWR0aCwgQHdvcmxkLmNhbnZhcy5oZWlnaHQsIDFcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQGlEZWx0YSA9IG5ldyBWZWN0b3IyKEB3b3JsZC5jYW1lcmEubW91c2UuZGVsdGEueCwgQHdvcmxkLmNhbWVyYS5tb3VzZS5kZWx0YS55KSBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgQHdvcmxkLmNhbWVyYS5tb3VzZS5idXR0b25zXG4gICAgICAgICAgICAgICAgQGlNb3VzZSA9IG5ldyBWZWN0b3I0KFxuICAgICAgICAgICAgICAgICAgICBAd29ybGQuY2FtZXJhLm1vdXNlLnBvcy54ICogKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvID8gMClcbiAgICAgICAgICAgICAgICAgICAgQGlSZXNvbHV0aW9uLnkgLSAoQHdvcmxkLmNhbWVyYS5tb3VzZS5wb3MueSAqICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyA/IEBpUmVzb2x1dGlvbi55KSlcbiAgICAgICAgICAgICAgICAgICAgKEB3b3JsZC5jYW1lcmEubW91c2UuYnV0dG9ucyBhbmQgMSBvciAtMSkgKiBAd29ybGQuY2FtZXJhLm1vdXNlLmRvd24ueCAqICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyA/IDApXG4gICAgICAgICAgICAgICAgICAgIChAd29ybGQuY2FtZXJhLm1vdXNlLmJ1dHRvbnMgYW5kIDEgb3IgLTEpICogKEBpUmVzb2x1dGlvbi55IC0gKEB3b3JsZC5jYW1lcmEubW91c2UuZG93bi55ICogKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvID8gQGlSZXNvbHV0aW9uLnkpKSkpXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgQGlNb3VzZSA9IG5ldyBWZWN0b3I0KFxuICAgICAgICAgICAgICAgICAgICBAd29ybGQuY2FtZXJhLm1vdXNlLnVwLnggKiAod2luZG93LmRldmljZVBpeGVsUmF0aW8gPyAwKVxuICAgICAgICAgICAgICAgICAgICBAaVJlc29sdXRpb24ueSAtIChAd29ybGQuY2FtZXJhLm1vdXNlLnVwLnkgKiAod2luZG93LmRldmljZVBpeGVsUmF0aW8gPyBAaVJlc29sdXRpb24ueSkpXG4gICAgICAgICAgICAgICAgICAgIChAd29ybGQuY2FtZXJhLm1vdXNlLmJ1dHRvbnMgYW5kIDEgb3IgLTEpICogQHdvcmxkLmNhbWVyYS5tb3VzZS5kb3duLnggKiAod2luZG93LmRldmljZVBpeGVsUmF0aW8gPyAwKVxuICAgICAgICAgICAgICAgICAgICAoQHdvcmxkLmNhbWVyYS5tb3VzZS5idXR0b25zIGFuZCAxIG9yIC0xKSAqIChAaVJlc29sdXRpb24ueSAtIChAd29ybGQuY2FtZXJhLm1vdXNlLmRvd24ueSAqICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyA/IEBpUmVzb2x1dGlvbi55KSkpKVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIEBpQ2VudGVyID0gbmV3IFZlY3RvcjMgLUB3b3JsZC5jYW1lcmEuY2VudGVyLngsIEB3b3JsZC5jYW1lcmEuY2VudGVyLnksIEB3b3JsZC5jYW1lcmEuY2VudGVyLnpcbiAgICAgICAgICAgIEBpQ2FtZXJhID0gbmV3IFZlY3RvcjMgLUB3b3JsZC5jYW1lcmEucG9zaXRpb24ueCwgQHdvcmxkLmNhbWVyYS5wb3NpdGlvbi55LCBAd29ybGQuY2FtZXJhLnBvc2l0aW9uLnpcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgQGlUaW1lICAgICAgPSBwZXJmb3JtYW5jZS5ub3coKS8xMDAwXG4gICAgICAgICAgICBAaVRpbWVEZWx0YSA9IEB3b3JsZC5lbmdpbmUuZ2V0RGVsdGFUaW1lKCkvMTAwMFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBAZnJhbWVSYXRlcy5wdXNoIEB3b3JsZC5lbmdpbmUuZ2V0RnBzKClcbiAgICAgICAgICAgIGlmIEBmcmFtZVJhdGVzLmxlbmd0aCA+IDMwIHRoZW4gQGZyYW1lUmF0ZXMuc2hpZnQoKVxuICAgICAgICAgICAgQGZwcyA9IDBcbiAgICAgICAgICAgIGZvciByIGluIEBmcmFtZVJhdGVzIHRoZW4gQGZwcyArPSByXG4gICAgICAgICAgICBAZnBzIC89IEBmcmFtZVJhdGVzLmxlbmd0aFxuICAgICAgICAgICAgXG4gICAgICAgICMgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgICBcbiAgICAgICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuICAgICAgICAjIDAwMDAwMDAwMCAgMDAwMDAwICAgICAgIDAwMCAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgXG4gICAgICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiAgICAgICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMDAwMDAwICAwMDAgICAwMDAgIFxuICAgICAgICBcbiAgICAgICAgQHNjZW5lLm9uQWZ0ZXJSZW5kZXJUYXJnZXRzUmVuZGVyT2JzZXJ2YWJsZS5hZGQgPT4gXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIEBidWZmZXIgdGhlbiBAdGV4dHVyZXMuYnVmZmVyLnVwZGF0ZSBAcmVuZGVyVGFyZ2V0LnJlYWRQaXhlbHMoKVxuICAgICAgICAgICAgXG4gICAgICAgIEBzY2VuZS5vbkFmdGVyUmVuZGVyT2JzZXJ2YWJsZS5hZGQgPT5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgQGlGcmFtZSsrXG4gICAgICAgICAgICBmb3IgaSBpbiBbMjU2Li4uNTEyXSBcbiAgICAgICAgICAgICAgICBAd29ybGQua2V5c1tpXSA9IDBcbiAgICAgICAgICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAgMCAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgcmVuZGVyOiAtPlxuXG4gICAgICAgIEBwbGFuZS5wb3NpdGlvbi5jb3B5RnJvbSBAd29ybGQuY2FtZXJhLnBvc2l0aW9uLmFkZCBAd29ybGQuY2FtZXJhLmdldERpcigpLnNjYWxlIDEuNVxuICAgICAgICBcbiAgICAgICAgQG1hdGVyaWFsRGF0YSBAc2hhZGVyTWF0ZXJpYWxcbiAgICAgICAgICAgICAgICBcbiAgICAjIDAwMDAwMDAgICAgIDAwMDAwMDAgICAwMDAwMDAwMDAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIFxuICAgIFxuICAgIG1hdGVyaWFsRGF0YTogKG0pID0+IFxuICAgICAgICBcbiAgICAgICAgbS5zZXRUZXh0dXJlICdpQ2hhbm5lbDAnICAgQHRleHR1cmVzLmtleXMgXG4gICAgICAgIG0uc2V0VGV4dHVyZSAnaUNoYW5uZWwxJyAgIEB0ZXh0dXJlcy5idWZmZXIgaWYgQGJ1ZmZlclxuICAgICAgICBtLnNldFRleHR1cmUgJ2lDaGFubmVsMicgICBAdGV4dHVyZXMuZm9udFxuICAgICAgICBtLnNldEludCAgICAgJ2lGcmFtZScgICAgICBAaUZyYW1lXG4gICAgICAgIG0uc2V0RmxvYXQgICAnaUNvbXBpbGUnICAgIEBjb21waWxlVGltZS8xMDAwXG4gICAgICAgIG0uc2V0RmxvYXQgICAnaVRpbWUnICAgICAgIEBpVGltZVxuICAgICAgICBtLnNldEZsb2F0ICAgJ2lUaW1lRGVsdGEnICBAaVRpbWVEZWx0YVxuICAgICAgICBtLnNldFZlY3RvcjIgJ2lEZWx0YScgICAgICBAaURlbHRhXG4gICAgICAgIG0uc2V0VmVjdG9yNCAnaU1vdXNlJyAgICAgIEBpTW91c2VcbiAgICAgICAgbS5zZXRWZWN0b3IzICdpUmVzb2x1dGlvbicgQGlSZXNvbHV0aW9uXG4gICAgICAgIG0uc2V0VmVjdG9yMyAnaUNlbnRlcicgICAgIEBpQ2VudGVyXG4gICAgICAgIG0uc2V0VmVjdG9yMyAnaUNhbWVyYScgICAgIEBpQ2FtZXJhXG4gICAgICAgIG0uc2V0RmxvYXQgICAnaURpc3QnICAgICAgIEB3b3JsZC5jYW1lcmEuZGlzdFxuICAgICAgICBtLnNldEZsb2F0ICAgJ2lNaW5EaXN0JyAgICBAd29ybGQuY2FtZXJhLm1pbkRpc3RcbiAgICAgICAgbS5zZXRGbG9hdCAgICdpTWF4RGlzdCcgICAgQHdvcmxkLmNhbWVyYS5tYXhEaXN0XG4gICAgICAgIG0uc2V0RmxvYXQgICAnaVJvdGF0ZScgICAgIEB3b3JsZC5jYW1lcmEucm90YXRlXG4gICAgICAgIG0uc2V0RmxvYXQgICAnaURlZ3JlZScgICAgIEB3b3JsZC5jYW1lcmEuZGVncmVlXG4gICAgICAgIG0uc2V0RmxvYXQgICAnaUZyYW1lUmF0ZScgIE1hdGgucm91bmQgQGZwc1xuICAgICAgICBtLnNldEZsb2F0ICAgJ2lNcycgICAgICAgICBAd29ybGQuZW5naW5lLmdldERlbHRhVGltZSgpXG4gICAgICAgICAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgXG4gICAgIyAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgc2hhZGVyTWF0ZXJpYWw6IChrZXkpIC0+XG4gICAgICAgIFxuICAgICAgICBuZXcgU2hhZGVyTWF0ZXJpYWwgXCIje2tleX1TaGFkZXJcIiwgQHNjZW5lLCAgXG4gICAgICAgICAgICAgICAgdmVydGV4OiAgIGtleVxuICAgICAgICAgICAgICAgIGZyYWdtZW50OiBrZXlcbiAgICAgICAgICAgICxcclxyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogWydwb3NpdGlvbicgJ25vcm1hbCcgJ3V2J11cbiAgICAgICAgICAgICAgICB1bmlmb3JtczogICBbXG4gICAgICAgICAgICAgICAgICAgICd3b3JsZFZpZXdQcm9qZWN0aW9uJ1xuICAgICAgICAgICAgICAgICAgICAnaUNhbWVyYScgJ2lDZW50ZXInICdpRGlzdCcgJ2lNYXhEaXN0JyAnaU1pbkRpc3QnXG4gICAgICAgICAgICAgICAgICAgICdpRnJhbWVSYXRlJyAnaU1zJyAnaUZyYW1lJyBcbiAgICAgICAgICAgICAgICAgICAgJ2lEZWx0YScgJ2lUaW1lJyAnaVRpbWVEZWx0YScgXG4gICAgICAgICAgICAgICAgICAgICdpTW91c2UnICdpUmVzb2x1dGlvbicgXG4gICAgICAgICAgICAgICAgICAgICdpUm90YXRlJyAnaURlZ3JlZScgXG4gICAgICAgICAgICAgICAgICAgICdpQ29tcGlsZSdcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgIFxuICAgIHNoYWRlckNvZGU6IChmcmFnU291cmNlKSAtPlxuICAgICAgICBcIlwiXCJcbiAgICAgICAgICAgIHByZWNpc2lvbiBoaWdocCBmbG9hdDtcbiAgICAgICAgICAgIHVuaWZvcm0gZmxvYXQgICAgIGlUaW1lO1xuICAgICAgICAgICAgdW5pZm9ybSBmbG9hdCAgICAgaVRpbWVEZWx0YTtcbiAgICAgICAgICAgIHVuaWZvcm0gZmxvYXQgICAgIGlGcmFtZVJhdGU7XG4gICAgICAgICAgICB1bmlmb3JtIGZsb2F0ICAgICBpTXM7XG4gICAgICAgICAgICB1bmlmb3JtIGZsb2F0ICAgICBpQ29tcGlsZTtcbiAgICAgICAgICAgIHVuaWZvcm0gZmxvYXQgICAgIGlEaXN0O1xuICAgICAgICAgICAgdW5pZm9ybSBmbG9hdCAgICAgaU1pbkRpc3Q7XG4gICAgICAgICAgICB1bmlmb3JtIGZsb2F0ICAgICBpTWF4RGlzdDtcbiAgICAgICAgICAgIHVuaWZvcm0gZmxvYXQgICAgIGlSb3RhdGU7XG4gICAgICAgICAgICB1bmlmb3JtIGZsb2F0ICAgICBpRGVncmVlO1xuICAgICAgICAgICAgdW5pZm9ybSB2ZWMyICAgICAgaURlbHRhO1xuICAgICAgICAgICAgdW5pZm9ybSB2ZWM0ICAgICAgaU1vdXNlO1xuICAgICAgICAgICAgdW5pZm9ybSB2ZWMzICAgICAgaVJlc29sdXRpb247XG4gICAgICAgICAgICB1bmlmb3JtIHZlYzMgICAgICBpQ2VudGVyO1xuICAgICAgICAgICAgdW5pZm9ybSB2ZWMzICAgICAgaUNhbWVyYTtcbiAgICAgICAgICAgIHVuaWZvcm0gaW50ICAgICAgIGlGcmFtZTtcbiAgICAgICAgICAgIHVuaWZvcm0gc2FtcGxlcjJEIGlDaGFubmVsMDtcbiAgICAgICAgICAgIHVuaWZvcm0gc2FtcGxlcjJEIGlDaGFubmVsMTtcbiAgICAgICAgICAgIHVuaWZvcm0gc2FtcGxlcjJEIGlDaGFubmVsMjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgI3tAY29tbW9uU291cmNlfVxuICAgICAgICAgICAgI3tmcmFnU291cmNlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB2b2lkIG1haW4odm9pZCkgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbWFpbkltYWdlKGdsX0ZyYWdDb2xvciwgZ2xfRnJhZ0Nvb3JkLnh5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFwiXCJcIlxuICAgICAgICAgICAgICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gU2hhZGVyXG4iXX0=
//# sourceURL=../coffee/shader.coffee